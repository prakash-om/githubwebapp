/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/MultiInput','sap/m/Bar','sap/m/Button','sap/m/ButtonType','sap/m/CheckBox','sap/m/Label','sap/m/LabelDesign','sap/m/Link','sap/m/List','sap/m/ListSeparators','sap/m/Panel','sap/m/PlacementType','sap/m/SearchField','sap/m/Text','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/Device','./VariantConverterFrom','./VariantConverterTo','sap/ui/comp/library','sap/ui/comp/smartvariants/PersonalizableInfo','sap/ui/comp/smartvariants/SmartVariantManagementUi2','sap/ui/comp/variants/VariantManagement','sap/ui/core/Icon','sap/ui/core/TextAlign','sap/ui/core/Title','sap/ui/core/ValueState','sap/ui/layout/Grid','sap/ui/layout/GridRenderer','sap/ui/layout/GridData','sap/ui/layout/HorizontalLayout','sap/ui/layout/ResponsiveFlowLayout','sap/ui/layout/ResponsiveFlowLayoutData','sap/ui/layout/VerticalLayout','sap/ui/layout/form/Form','sap/ui/layout/form/FormContainer','sap/ui/layout/form/FormElement','sap/ui/layout/form/ResponsiveGridLayout','sap/ui/layout/form/FormRenderer'],function(q,M,B,a,b,C,L,c,d,e,f,P,g,S,T,h,k,D,V,l,m,o,p,r,I,s,t,u,G,v,w,H,R,x,y,F,z,A,E,J){"use strict";var K=G.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designTime:true,properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:null},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"}},associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{},assignedFiltersChanged:{}}},renderer:v.render});K.INTERNAL_GROUP="__$INTERNAL$";K.prototype.init=function(){this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._oHideShowButton=null;this._oSearchButton=null;this._oFiltersButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oDialog=null;this._oFilterDialog=null;this._bIsInitialized=false;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._bDoItOnce=false;this._oLabelTextWidth=0;this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.setHSpacing(0);this.addStyleClass("sapUiCompFilterBar");if(this._isPhone()){this.addStyleClass("sapUiCompFilterBarPhone");}else{this.addStyleClass("sapUiCompFilterBarNonPhone");}this.addStyleClass("sapUiCompFilterBarMarginBottom");this.addStyleClass("sapUiCompFilterBarPaddingPanel");this.addStyleClass("sapContrastPlus");this._oToolbar=this._createToolbar();this._oToolbar.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oToolbar);this._oBasicAreaLayout=this._createBasicAreaLayout();this._oBasicAreaLayout.setLayoutData(new w({span:"L12 M12 S12"}));this.addContent(this._oBasicAreaLayout);this._oAdvancedPanel=new P();this._oAdvancedPanel.setLayoutData(new w({span:"L12 M12 S12"}));this._oAdvancedPanel.setVisible(false);this._oAdvancedAreaForm=this._createAdvancedAreaForm();this._oAdvancedPanel.addContent(this._oAdvancedAreaForm);this.addContent(this._oAdvancedPanel);this._hResizeListener=sap.ui.core.ResizeHandler.register(this._oBasicAreaLayout,q.proxy(this._fHandleResize,this));this.oModel=new sap.ui.model.json.JSONModel({});this.setModel(this.oModel,"FilterBar");this._oHintText=new T({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:s.Center});this._oHintText.setVisible(false);this._oHintText.addStyleClass("sapUiCompFilterBarHint");this._oBasicAreaLayout.addContent(this._oHintText);if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false);}};K.prototype._hasAnyVisibleFiltersOnFB=function(){var j=this._retrieveVisibleAdvancedItems();for(var i=0;i<j.length;i++){if(j[i].filterItem.getVisibleInFilterBar()){return true;}}return false;};K.prototype._showHintText=function(){var i=0;if(!this._oHintText){return;}if(!this.getAdvancedMode()&&!this._isPhone()){var j=!this._hasAnyVisibleFiltersOnFB();if(j&&this._mAdvancedAreaFilter){i=this._oBasicAreaLayout.indexOfContent(this._oHintText);if(i<0){this._oBasicAreaLayout.insertContent(this._oHintText,0);}}this._oHintText.setVisible(j);if(i<0){this._oBasicAreaLayout.rerender();}}};K.prototype._hasRelevantFilters=function(){var i,n=null,j;if(!this._mAdvancedAreaFilter||(Object.keys(this._mAdvancedAreaFilter)<1)){return false;}if(this.getAdvancedMode()){for(n in this._mAdvancedAreaFilter){var N=this._mAdvancedAreaFilter[n];if(N&&N.items){for(i=0;i<N.items.length;i++){j=N.items[i];if(j){if(this._determineVisibility(j.filterItem)){return true;}}}}}return false;}return true;};K.prototype._adaptButtonsEnablement=function(){var i=false||!!this._mAdvancedAreaFilter;if(this._oHideShowButton){this._oHideShowButton.setEnabled(i);if(this.getAdvancedMode()&&!this._isPhone()){this._oHideShowButton.setVisible(this._hasRelevantFilters());}}this._oClearButtonOnFB.setEnabled(i);this._oRestoreButtonOnFB.setEnabled(i);this._oFiltersButton.setEnabled(i);if(i&&this.getFilterBarExpanded()&&!this._isPhone()&&!this.getAdvancedMode()){this._oBasicAreaLayout.setVisible(true);}};K.prototype.getVariantManagement=function(){return this._oVariantManagement;};K.prototype.setShowClearOnFB=function(i){if(!this._isPhone()){this.setProperty("showClearOnFB",i);this._oClearButtonOnFB.setVisible(i);}};K.prototype.setShowRestoreOnFB=function(i){if(!this._isPhone()){this.setProperty("showRestoreOnFB",i);this._oRestoreButtonOnFB.setVisible(i);}};K.prototype.setShowGoOnFB=function(i){this.setProperty("showGoOnFB",i);this._calcVisibilityGoButton();};K.prototype._calcVisibilityGoButton=function(){var i=this.getShowGoOnFB();if(i&&!this._isPhone()&&this.getLiveMode&&this.getLiveMode()){i=false;}this._oSearchButton.setVisible(i);};K.prototype.setShowGoButton=function(i){this.setShowGoOnFB(i);};K.prototype.getShowGoButton=function(){return this.getShowGoOnFB();};K.prototype.hideGoButton=function(){this._oSearchButton.setVisible(false);};K.prototype.restoreGoButton=function(){this._oSearchButton.setVisible(this.getShowGoOnFB());};K.prototype.setShowFilterConfiguration=function(i){this.setProperty("showFilterConfiguration",i);if(this._oFiltersButton&&!this._isPhone()){this._oFiltersButton.setVisible(i);}};K.prototype.isCurrentVariantStandard=function(){var i;if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();if(i===""){return true;}return(i===this._oVariantManagement.getStandardVariantKey());}return undefined;};K.prototype.setCurrentVariantId=function(i,j){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(i,j);}};K.prototype.getCurrentVariantId=function(){var i="";if(this._oVariantManagement){i=this._oVariantManagement.getCurrentVariantId();}return i;};K.prototype.getDataSuiteFormat=function(i){var j=null;var n,N,O;if(this._oVariantManagement){n=this.getCurrentVariantId();if(this.getFilterDataAsString){O=this._determineVariantFiltersInfo(i,true);N=this.getFilterDataAsString(i);if(N){var Q=new l();j=Q.convert(n,O,N,this);}}}return j;};K.prototype.setDataSuiteFormat=function(i,j){var n,N;if(i){n=new V();N=n.convert(i,this);if(N){if(N.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(N.variantId,"DATA_SUITE");}else{this._setFilterVisibility(N.variantId);}}this._oVariantManagement.setInitialSelectionKey(N.variantId);}if(N.payload&&this.setFilterDataAsString){this.setFilterDataAsString(N.payload,j);}}}};K.prototype._setFilterVisibility=function(i){if(this._oVariantManagement.getSelectionKey()!==i){this._oVariantManagement.setInitialSelectionKey(i);var j=this._getStandardVariant();if(j){var n=this._oVariantManagement.getVariantContent(this,i);if(n&&n.filterbar){if(n.version==="V2"){n=this.mergeVariant(j,n);}this._reapplyVisibility(n.filterbar);}}}};K.prototype.applySettings=function(j){if(this._possibleToChangeVariantManagement()){if(j&&j.customData){for(var i=0;i<j.customData.length;i++){var n=j.customData[i];if(n&&n.mProperties&&n.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(n.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true;}}}}if(j&&j.persistencyKey){this._bHostedVariantManagement=true;}G.prototype.applySettings.apply(this,arguments);};K.prototype.setPersistencyKey=function(i){this.setProperty("persistencyKey",i);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(true);}};K.prototype._possibleToChangeVariantManagement=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){return true;}return false;};K.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection();}};K.prototype.setSearchEnabled=function(i){this.setProperty("searchEnabled",i);if(this._oSearchButton){this._oSearchButton.setEnabled(i);}};K.prototype.getSearchEnabled=function(){return this.getProperty("searchEnabled");};K.prototype.setSearchButtonEmphType=function(i){};K.prototype.setSimplifiedMode=function(i){};K.prototype.getSimplifiedMode=function(){if(this.getAdvancedMode()){return false;}return true;};K.prototype.setExpandAdvancedArea=function(i){this.setFilterBarExpanded(i);};K.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded();};K.prototype.setAdvancedMode=function(i){this.setProperty("advancedMode",i);this.toggleStyleClass("sapContrastPlus",!i);if(i){if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}if(this._oToolbar){this._oToolbar.addStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");if(this._oBasicSearchField){if(this._oToolbar.indexOfContent(this._oBasicSearchField)<0){this._oToolbar.insertContent(this._oBasicSearchField,1);}}}}else{if(this.getPersistencyKey()&&this._possibleToChangeVariantManagement()){if(this._oVariantManagement){this._oVariantManagement.setVisible(true);}if(this._oToolbar){this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}}this._oFiltersButton.setVisible(!i);if(this._oHideShowButton){this._oHideShowButton.setVisible((i&&this._isPhone())?false:true);}this._oBasicAreaLayout.setVisible(!i&&this.getFilterBarExpanded());this._oAdvancedPanel.setVisible(i&&this.getFilterBarExpanded());this._adaptButtonsEnablement();};K.prototype.setUseToolbar=function(i){this.setProperty("useToolbar",i);if(!i){this._adaptNewFilterBarDesign();}};K.prototype.setHeader=function(i){this.setProperty("header",i);if(this.getUseToolbar()){this._addHeaderToToolbar(i);}};K.prototype._addHeaderToToolbar=function(i){if(this._oToolbar){if(this._oVariantManagement&&(this._oVariantManagement.getVisible()||this._bHostedVariantManagement)&&(this._oToolbar.indexOfContent(this._oVariantManagement)>-1)){if(!this._oSeparator){q.sap.require("sap.m.ToolbarSeparator");this._oSeparator=new sap.m.ToolbarSeparator();this._oToolbar.setHeight("3rem");}this._oToolbar.removeContent(this._oSeparator);this._oToolbar.insertContent(this._oSeparator,0);}if(!this._oText){this._oText=new T();this._oText.addStyleClass("sapMH4Style");this._oText.addStyleClass("sapUiCompSmartChartHeader");}this._oText.setText(i);this._oToolbar.removeContent(this._oText);this._oToolbar.insertContent(this._oText,0);}};K.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false;}if(!this.getUseToolbar()){return true;}return false;};K.prototype._adaptNewFilterBarDesign=function(){if(this._isNewFilterBarDesign()){this.setFilterBarExpanded(true);this._oBasicAreaLayout.setVisible(true);if(this.getUseToolbar()){var j=this._oToolbar.getContent();for(var i=j.length-1;i>0;i--){this._oToolbar.removeContent(j[i]);}}else{if(this._oToolbar){this.removeContent(this._oToolbar);this._oToolbar.removeAllContent();this._oToolbar.destroy();this._oToolbar=null;}}if(this._oHintText){this._oBasicAreaLayout.removeContent(this._oHintText);this._oHintText.destroy();this._oHintText=null;}if(this._oHideShowButton){this._oHideShowButton.destroy();this._oHideShowButton=null;}if(!this._bButtonaAdded){this._bButtonaAdded=true;this._addButtonsToBasicArea();}}};K.prototype._addButtonsToBasicArea=function(){var i=new y();if(sap.ui.getCore().getConfiguration().getRTL()){i.addStyleClass("sapUiCompFilterBarFloatLeft");}else{i.addStyleClass("sapUiCompFilterBarFloatRight");}var j=new H();j.setLayoutData(new x({margin:true}));i.addContent(new T());i.addContent(j);j.addContent(this._oClearButtonOnFB);this._oClearButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oRestoreButtonOnFB);this._oRestoreButtonOnFB.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oFiltersButton);this._oFiltersButton.addStyleClass("sapUiCompFilterBarPaddingRightBtn");j.addContent(this._oSearchButton);this._updateToolbarText();i.addStyleClass("sapUiCompFilterBarPaddingRight");if(this._isPhone()){i.addStyleClass("sapUiCompFilterBarRemoveMinWidth");this._oBasicAreaLayout.insertContent(i,0);}else{i.addStyleClass("sapUiCompFilterBarPaddingTop");this._oBasicAreaLayout.addContent(i);}};K.prototype._addBasicSearchToBasicArea=function(j){var n=null;if(this._oBasicSearchFieldContainer){if(this._oBasicSearchFieldContainer.$()){n=this._oBasicSearchFieldContainer.$().width();}if(!n){n=this._oBasicSearchFieldContainer.getWidth();}var N=this._oBasicSearchFieldContainer.removeAllContent();if(N){for(var i=0;i<N.length;i++){if(N[i]!==this._oBasicSearchField){N[i].destroy();}}}this._oBasicSearchFieldContainer.destroy();this._oBasicSearchFieldContainer=null;}if(j){var O=new L({text:"\u2008"});O.addStyleClass("sapBasicSearchFilter");var Q=this._addControlToBasicAreaContainer(null,j,O);if(Q){Q.setVisible(true);var U=0;if(this._isPhone()){U=1;}this._oBasicAreaLayout.insertContent(Q,U);this._oBasicSearchFieldContainer=Q;if(n){if(typeof n==='string'){this._oBasicSearchFieldContainer.setWidth(n);}else{this._oBasicSearchFieldContainer.setWidth(n+"px");}}}}};K.prototype._setCollectiveSearch=function(i){if(this.getAdvancedMode()&&i){if(this._oToolbar){if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement);this._oVariantManagement=null;}if(this._oCollectiveSearch){this._oToolbar.removeContent(this._oCollectiveSearch);}this._oCollectiveSearch=i;this._oToolbar.insertContent(this._oCollectiveSearch,0);this._oToolbar.removeStyleClass("sapUiCompFilterBarToolbarBasicSearchNoVariant");}}};K.prototype.setBasicSearch=function(i){this.setAssociation("basicSearch",i,true);var j=this;if(this._oBasicSearchField&&this._oToolbar){this._oToolbar.removeContent(this._oBasicSearchField);}if(i&&this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(i);}else{if(i&&this._oToolbar&&(!this._isPhone()||this.getAdvancedMode())){var n=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(i,n);if(this._isUi2Mode()){i.attachLiveChange(function(N){j.fireFilterChange(N);});}}}this._oBasicSearchField=i;};K.prototype._indexOfSpacerOnToolbar=function(){var j=this._oToolbar.getContent(),i;if(j){for(i=0;i<j.length;i++){if(j[i]instanceof k){return i;}}}return 0;};K.prototype.addFilterItem=function(i){var n,j,N;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty");}j=i.getControl();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty");}this.addAggregation("filterItems",i,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[];}var O={control:i.getControl(),filterItem:i};this._aBasicAreaSelection.push(O);N=new sap.ui.comp.filterbar.FilterGroupItem({label:i.getLabel(),labelTooltip:i.getLabelTooltip(),name:i.getName(),mandatory:i.getMandatory(),visible:i.getVisible(),visibleInFilterBar:i.getVisibleInFilterBar(),partOfCurrentVariant:true,control:i.getControl(),groupName:K.INTERNAL_GROUP,groupTitle:"",hiddenFilter:i.getHiddenFilter()});N._iSpan=i._iSpan;if(i.data('isCustomField')){N.data('isCustomField',true);}i.attachChange(this._filterItemChange.bind(this,null));this.addFilterGroupItem(N);};K.prototype.addFilterGroupItem=function(i){var n,j,O,N;if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty");}this.addAggregation("filterGroupItems",i,true);j=i.getGroupName();if(!j){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty");}n=i.getName();if(!n){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty");}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[j]){this._mAdvancedAreaFilter[j]={};this._mAdvancedAreaFilter[j].filterItem=null;this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].items){this._mAdvancedAreaFilter[j].items=[];}if(!this._mAdvancedAreaFilter[j].filterItem){this._mAdvancedAreaFilter[j].filterItem=i;}O={control:i.getControl(),filterItem:i};if(this.getAdvancedMode()||i.getVisibleInFilterBar()){i.setVisibleInFilterBar(true);}else{i.setVisibleInFilterBar(false);}this._mAdvancedAreaFilter[j].items.push(O);if(!i.getHiddenFilter()){N=this._addControlToBasicAreaFormContainer(i);if(N){O.container=N;N.setVisible(i.getVisible()&&i.getVisibleInFilterBar());if(i.getVisibleInFilterBar()){i.setPartOfCurrentVariant(i.getVisibleInFilterBar());}i.attachChange(this._filterGroupItemChange.bind(this));}if(this.getAdvancedMode()){this._rerenderAA();}else{this._showHintText();}}this._adaptButtonsEnablement();};K.prototype._addParameter=function(j){var i,O,n,N=false,Q=K.INTERNAL_GROUP;j._setParameter(true);j.setVisibleInFilterBar(true);j.setPartOfCurrentVariant(true);this.addAggregation("_parameters",j,true);O={control:j.getControl(),filterItem:j};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};}if(!this._mAdvancedAreaFilter[Q]){this._mAdvancedAreaFilter[Q]={};this._mAdvancedAreaFilter[Q].filterItem=null;}if(!this._mAdvancedAreaFilter[Q].items){this._mAdvancedAreaFilter[Q].items=[];}for(i=0;i<this._mAdvancedAreaFilter[Q].items.length;i++){var U=this._mAdvancedAreaFilter[Q].items[i];if(U.filterItem._isParameter()){continue;}this._mAdvancedAreaFilter[Q].items.splice(i,0,O);N=true;break;}if(!N){this._mAdvancedAreaFilter[Q].items.push(O);}n=this._addControlToBasicAreaFormContainer(j);if(n){O.container=n;n.setVisible(j.getVisible());}if(N){this._oBasicAreaLayout.removeContent(n);this._addContainerInOrder(O.filterItem,O.container);}if(!this.getAdvancedMode()){this._showHintText();}this._adaptButtonsEnablement();};K.prototype._filterItemChange=function(i,j){var n;var N;var O;if(j&&j.oSource&&(j.oSource instanceof sap.ui.comp.filterbar.FilterItem)){O=j.getParameter("propertyName");if(O==="visibleInFilterBar"||O==="visible"||O==="label"||O==="labelTooltip"||O==="mandatory"){n=this._determineItemByName(j.oSource.getName(),K.INTERNAL_GROUP);if(n&&n.filterItem){if((O==="visible")){N=j.oSource.getVisible();n.filterItem.setVisible(N);}else if(O==="visibleInFilterBar"){N=j.oSource.getVisibleInFilterBar();var Q=this._checkChangePossibleVisibleInFilterBar(n.filterItem,N);if(Q){n.filterItem.setVisibleInFilterBar(N);}else{j.oSource.setVisibleInFilterBar(true);}}else if(O==="label"){n.filterItem.setLabel(j.oSource.getLabel());}else if(O==="labelTooltip"){n.filterItem.setLabelTooltip(j.oSource.getLabelTooltip());}else if(O==="mandatory"){N=j.oSource.getMandatory();n.filterItem.setMandatory(N);}}}}};K.prototype._filterGroupItemChange=function(i){var j;var n;if(i&&i.oSource){n=i.getParameter("propertyName");if(n==="visibleInFilterBar"||n==="visible"){j=this._determineItemByName(i.oSource.getName(),i.oSource.getGroupName());if(j){if(n==="visibleInFilterBar"){var N=i.oSource.getVisibleInFilterBar();var O=this._checkChangePossibleVisibleInFilterBar(i.oSource,N);if(!O){i.oSource.setVisibleInFilterBar(true);N=true;}if(N){i.oSource.setPartOfCurrentVariant(true);}if(!this.getAdvancedMode()&&!this._oDialog){this._rerenderItem(j);this._adaptLinkText(i.oSource.getGroupName());}}else if(n==="visible"){if(this.getAdvancedMode()&&j.container){j.container.setVisible(true);}else{this._updateToolbarText();this._rerenderGroup(j,i.oSource.getGroupName());}}this._showHintText();}}else if(n==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i.oSource.getGroupName()]){if(this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer.setTitle(i.oSource.getGroupTitle());}else{this._adaptGroupTitle(i.oSource.getGroupName());}}}else if(n==="label"){if(!this._mAdvancedAreaFilter[i.oSource.getGroupName()].formcontainer){this._adaptGroupTitleForFilter(i.oSource);}}else if(n==="mandatory"){if(this._oFilterDialog){this._adaptMandatoryForFilter(i.oSource);}}if(this.getAdvancedMode()){this._rerenderAA();}}};K.prototype._addContainer=function(i){if(i){if(this._oBasicAreaLayout&&!this._oFilterDialog){if(i.container&&(this._oBasicAreaLayout.indexOfContent(i.container)===-1)){this._addContainerInOrder(i.filterItem,i.container);}}}};K.prototype._addContainerInOrder=function(j,N){var n,i,O,Q=this._oBasicAreaLayout.getContent(),U=-1;if(this._isNewFilterBarDesign()&&this._oBasicSearchField){U++;}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){var W=this._mAdvancedAreaFilter[n];if(W&&W.items){for(i=0;i<W.items.length;i++){if(!W.items[i].container){continue;}if(W.items[i].container===N){this._oBasicAreaLayout.insertContent(N,U+1);return;}O=Q.indexOf(W.items[i].container);if(O>=0){U=O;}}}}}};K.prototype._checkChangePossibleVisibleInFilterBar=function(i,j){if(i&&i.getMandatory()&&!j){var n=this._hasFilterValue(i);if(!n){i.setVisibleInFilterBar(true);return false;}}return true;};K.prototype._adaptLinkText=function(i){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[i]&&this._mAdvancedAreaFilter[i].link){this._setLinkText(i,this._mAdvancedAreaFilter[i].link);}};K.prototype._hasFilterValue=function(i){var j=this._getFiltersWithValues();return this._checkFilterForValue(j,i);};K.prototype._adaptMandatoryForFilter=function(i){var j;var n=i.getGroupName();if(i){j=this._determineItemByName(i.getName(),n);if(j&&j.checkbox&&j.checkbox.getVisible()){var N=true;if(i.getMandatory()){var O=this._hasFilterValue(i);if(!O){N=false;i.setVisibleInFilterBar(true);}}j.checkbox.setEnabled(N);}}};K.prototype._adaptGroupTitleForFilter=function(i){var j;var n;if(i&&!i.getHiddenFilter()){j=i.getLabel();n=i.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(n&&i.getGroupTitle()){n.setText(j+" ("+i.getGroupTitle()+')');}}else{n.setText(j);}}};K.prototype._adaptGroupTitle=function(j){var i;var n;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if(n&&n){this._adaptGroupTitleForFilter(n.filterItem);}}}};K.prototype._adaptGroupsTitle=function(){var n=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&n!==K.INTERNAL_GROUP){this._adaptGroupTitle(n);}}}};K.prototype.registerGetFiltersWithValues=function(i){this._fRegisterGetFiltersWithValues=i;};K.prototype.registerFetchData=function(i){this._fRegisteredFetchData=i;};K.prototype.registerApplyData=function(i){this._fRegisteredApplyData=i;};K.prototype._isTINAFScenario=function(){if(this._oVariantManagement){if(!this._isUi2Mode()){return true;}}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true;}}return false;};K.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null);}this._fireInitialiseEvent();}else{this._initializeVariantManagement();}};K.prototype.variantsInitialized=function(){this.fireInitialized();};K.prototype.fireInitialized=function(){this.fireEvent("initialized");};K.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this);}else{this._fInitialiseVariants=q.proxy(this._initialiseVariants,this);this._oVariantManagement.attachInitialise(this._fInitialiseVariants,this);this._oVariantManagement.initialise();}}else{this._fireInitialiseEvent();}};K.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise");}catch(i){q.sap.log.error("error during initialise event handling - "+i.message);}this._bIsInitialized=true;this._updateToolbarText();};K.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};K.prototype.fireAfterVariantLoad=function(i,j){this._rerenderFilters();var n={context:i,executeOnSelect:j};this.fireEvent("afterVariantLoad",n);};K.prototype.fireBeforeVariantSave=function(i){var j={context:i};var n=this._getConsiderFilterChanges();if(i){this._setConsiderFilterChanges(false);}this.fireEvent("beforeVariantSave",j);if(i){this._setConsiderFilterChanges(n);}};K.prototype.removeAllFilterItems=function(){var i;var j;this._aBasicAreaSelection=null;var n=this._oBasicAreaLayout.getContent();if(n){for(i=0;i<n.length;i++){this._oBasicAreaLayout.removeContent(n[i]);}}j=this.getFilterItems();if(this._mAdvancedAreaFilter){if((this._mAdvancedAreaFilter[K.INTERNAL_GROUP])&&(this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items)){for(i=0;i<this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items.length;i++){if(this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items[i].filterItem){j.push(this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items[i].filterItem);}}delete this._mAdvancedAreaFilter[K.INTERNAL_GROUP];}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this._destroyItems(j);this._adaptButtonsEnablement();};K.prototype.removeAllFilterGroupItems=function(){var n=null,i;var j=[];for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){if(this._mAdvancedAreaFilter[n].items[i].filterItem){j.push(this._mAdvancedAreaFilter[n].items[i].filterItem);}}delete this._mAdvancedAreaFilter[n];}}if(Object.keys(this._mAdvancedAreaFilter).length===0){this._mAdvancedAreaFilter=null;}}this.__bDeleteMode=true;this._destroyItems(j);this.__bDeleteMode=false;this._adaptButtonsEnablement();};K.prototype.removeAllFilters=function(){this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch();};K.prototype.removeBasicSearch=function(){this.setBasicSearch(null);};K.prototype.getAllFilterItems=function(j){var i,n=null;var N=[];var O,Q;if(!j){this._ensureFilterLoaded(null);}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){O=this._mAdvancedAreaFilter[n];if(O.items){for(i=0;i<O.items.length;i++){Q=O.items[i];if(Q&&Q.filterItem&&Q.filterItem.getVisible()&&!Q.filterItem.getHiddenFilter()){if(j){if(Q.filterItem.getVisibleInFilterBar()||Q.filterItem.getPartOfCurrentVariant()){N.push(Q.filterItem);}}else{N.push(Q.filterItem);}}}}}}}return N;};K.prototype._clearErrorState=function(){var i;var j;var n=this.determineMandatoryFilterItems();if(n){for(i=0;i<n.length;i++){j=this.determineControlByFilterItem(n[i]);if(j&&j.setValueState){j.setValueState(u.None);}}}};K.prototype.getAggregation=function(n){if(n=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null);}return G.prototype.getAggregation.apply(this,arguments);};K.prototype._getFilterInformation=function(){return[];};K.prototype._getAnalyticParametersInformation=function(){return[];};K.prototype._createVisibleFilters=function(){this._getFilters();};K.prototype._getFilters=function(){this._aFields=this._getFilterInformation();var i,j;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[K.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[K.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[K.INTERNAL_GROUP].items=null;}}for(i=0;i<this._aFields.length;i++){j=this._aFields[i];if(j.groupName!==K.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[j.groupName]){this._mAdvancedAreaFilter[j.groupName]={};this._mAdvancedAreaFilter[j.groupName].groupTitle=j.groupTitle;this._mAdvancedAreaFilter[j.groupName].filterItem=null;this._mAdvancedAreaFilter[j.groupName].items=[];}}if(j.visibleInAdvancedArea||(j.groupName===K.INTERNAL_GROUP)){this._instanciateFilterItem(j);}}}this._adaptButtonsEnablement();};K.prototype._ensureFilterLoaded=function(n){var i,j,N;if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){N=this._aFields[j];if(!N.factory){continue;}if(n){for(i=0;i<n.length;i++){if((N.fieldName===n[i].name)&&(N.groupName===n[i].group)){this._instanciateFilterItem(N);break;}}}else{this._instanciateFilterItem(N);}}if(!n){this._aFields=[];}}};K.prototype._instanciateFilterItem=function(i){if(i.factory){i.factory();delete i.factory;}};K.prototype._destroyItems=function(j){if(j&&j.length){for(var i=0;i<j.length;i++){j[i].destroy();}}};K.prototype._reapplyVisibility=function(j){var i,n=null;var N;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var O=this._mAdvancedAreaFilter[n];if(O&&O.items){for(i=0;i<O.items.length;i++){N=O.items[i];if(N&&N.filterItem){this._setPersVisibility(j,N.filterItem);}}if(n!==K.INTERNAL_GROUP){this._adaptLinkText(n);}}}}}};K.prototype._setPersVisibility=function(i,j){var n,N;var O;if(j&&!j.getHiddenFilter()){N=j.getName();n=j.getGroupName();O=this._checkForFilterInfo(i,N,n);if(this._isTINAFScenario()){if(O){j.setVisibleInFilterBar(O.visibleInFilterBar);j.setPartOfCurrentVariant(O.partOfCurrentVariant);if(O.hasOwnProperty("visible")){j.setVisible(O.visible);}}else{j.setVisibleInFilterBar(false);j.setPartOfCurrentVariant(n===K.INTERNAL_GROUP);}}else{if(O&&(O.visibleInFilterBar!==undefined)){j.setVisibleInFilterBar((O.visibleInFilterBar));j.setPartOfCurrentVariant((O.partOfCurrentVariant));}else{if((n!==K.INTERNAL_GROUP)&&O&&(O.group===n)){j.setVisibleInFilterBar((O!==null));}}}if(n===K.INTERNAL_GROUP){j.setPartOfCurrentVariant(true);}}};K.prototype._checkForFilterInfo=function(j,n,N){var i;var O=null;if(j&&j.length){for(i=0;i<j.length;i++){if((j[i].name===n)&&(j[i].group===N)){O=j[i];break;}}}return O;};K.prototype._createVariantManagement=function(){var i=new p(this.getId()+"-variantUi2",{});var j=new o({type:"filterBar",keyName:"persistencyKey"});j.setControl(this);i.addPersonalizableControl(j);i.addStyleClass("sapUiCompFilterBarMarginLeft");return i;};K.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged");};K.prototype.retrieveFiltersWithValuesAsText=function(){var j,n,N=this.retrieveFiltersWithValues(),O;if(!N||(N.length===0)){j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO");}else{if(!this._isPhone()){O=Math.min(5,N.length);n="";for(var i=0;i<O;i++){n+=N[i];if(i<(O-1)){n+=', ';}}j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[N.length,n]);if(O<N.length){j+=", ...";}}else{j=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[N.length]);}}return j;};K.prototype.retrieveFiltersWithValues=function(){var i,j=[];var n=this._getFiltersWithValues();if(n){for(i=0;i<n.length;i++){if(n[i].getVisible()&&n[i].getPartOfCurrentVariant()){j.push(n[i].getLabel());}}}return j;};K.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues();}catch(i){q.sap.log.error("callback for obtaining the filter count throws an exception");}}return null;};K.prototype._getFiltersWithValuesCount=function(){var n=0;var i=this.retrieveFiltersWithValues();n=i.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){n++;}return n;};K.prototype._checkFilterForValue=function(j,n){var i;if(j){for(i=0;i<j.length;i++){if(j[i]===n){return true;}}}return false;};K.prototype._handleVisibilityOfToolbar=function(){if(this.getAdvancedMode()&&this._oToolbar){var j=false;var n=this._oToolbar.getContent();for(var i=0;i<n.length;i++){if(n[i]instanceof k){continue;}if(n[i].getVisible&&n[i].getVisible()){j=true;break;}}this._oToolbar.setVisible(j);}};K.prototype._toggleHideShow=function(){this.setFilterBarExpanded(!this.getFilterBarExpanded());};K.prototype._updateToolbarText=function(){var i=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var Z=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var n=this._getFiltersWithValuesCount();var j=n?(this._oRb.getText(i,[n])):(this._oRb.getText(Z));this._oFiltersButton.setText(j);this.fireAssignedFiltersChanged();};K.prototype.setFilterBarExpanded=function(i){if(this.getAdvancedMode()){this.setProperty("filterBarExpanded",i);if(this._oHideShowButton){if(i){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_VH_SHOW"));}}this._calcVisibilityGoButton();this._oAdvancedPanel.setVisible(i);}else{var j=this._isPhone()?false:i;this.setProperty("filterBarExpanded",j);if(this._isNewFilterBarDesign()){return;}if(this._isPhone()){if(this._oHideShowButton){this._oHideShowButton.setVisible(false);}this._calcVisibilityGoButton();this._oBasicAreaLayout.setVisible(false);}else{if(this._oHideShowButton){if(j){this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_HIDE"));}else{this._oHideShowButton.setText(this._oRb.getText("FILTER_BAR_SHOW"));}this._oHideShowButton.setVisible(true);}this._calcVisibilityGoButton();if(this._oHideShowButton){if(this._oHideShowButton.getEnabled()){this._oBasicAreaLayout.setVisible(j);}else{this._oBasicAreaLayout.setVisible(false);}}}}this._updateToolbarText();};K.prototype._selectionChangedInFilterDialog=function(i,j){j.setVisibleInFilterBar(i.getSelected());if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}this._bDirtyViaDialog=true;};K.prototype._mandatoryFilterChange=function(i){if(!i){return;}var j=i.getParameters();if(!j||!j.oSource){return;}var n=this._determineByControl(j.oSource);if(n&&n.checkbox){var N=n.filterItem;if(!N.getMandatory()){return;}var O=this._hasFilterValue(N);if(N.getVisibleInFilterBar()){if(O){n.checkbox.setEnabled(true);}else{n.checkbox.setEnabled(false);}}else{if(!O){N.setVisibleInFilterBar(true);n.checkbox.setSelected(true);n.checkbox.setEnabled(false);}}}};K.prototype._createFiltersAndAdaptBasicArea=function(){var i;this._setConsiderFilterChanges(false);this._recreateBasicAreaContainer(true);i=this._createFilters();var j=this._retrieveVisibleAdvancedItems();if(!j||(j.length<=0)){this._oAddToFilterBarLabel.setVisible(false);}this._setConsiderFilterChanges(true);return i;};K.prototype._determineNotAssignedFiltersCount=function(j){var n=0,i,N;if(this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){N=this._mAdvancedAreaFilter[j].items[i].filterItem;if(!N.getVisible()||N.getHiddenFilter()){continue;}if(!N.getPartOfCurrentVariant()&&!N.getVisibleInFilterBar()){n++;}}}return n;};K.prototype._rerenderGroup=function(j,n){var i;var N;this._rerenderItem(j);this._adaptLinkText(n);if(j.formelement){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items&&this._mAdvancedAreaFilter[n].formcontainer){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){N=this._mAdvancedAreaFilter[n].items[i].filterItem;if(N&&N.getVisible()){this._mAdvancedAreaFilter[n].formcontainer.setVisible(true);return;}}this._mAdvancedAreaFilter[n].formcontainer.setVisible(false);}}};K.prototype._setLinkTextAndCount=function(i,j,n){var N;if(n){N=this._oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[n]);}else{N=this._oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS");}j.setText(N);};K.prototype._setLinkText=function(i,j){var n=this._determineNotAssignedFiltersCount(i);this._setLinkTextAndCount(i,j,n);};K.prototype._createLink=function(i,j){var n=this;var N=new d();this._setLinkText(i,N);N.attachPress(function(){n._createAddRemoveFiltersDialog(i,N);});if(j){N.addAriaLabelledBy(j);}return N;};K.prototype._isPhone=function(){return(D.system.phone)?true:false;};K.prototype._isTablet=function(){return(D.system.tablet&&!D.system.desktop)?true:false;};K.prototype._createForm=function(i){var j=this;var n=null;n=F.extend('sap.ui.comp.filterbar.Form',{metadata:{},renderer:function(N,O){J.render.apply(this,arguments);}});(function(){n.prototype.contentOnAfterRendering=function(){F.prototype.contentOnAfterRendering.apply(this,arguments);j._adaptStyleSheet();if(j._oFilterDialog&&j._oFilterDialog.isOpen()&&(j._isNewFilterBarDesign()||!j._isPhone())){j._repositionAddToFilterBarLabel();}};}());return new n({editable:true,layout:i});};K.prototype._adaptStyleSheet=function(){var i,O;var j,N,n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.control&&j.control instanceof M){N=j.control.$();if(N){O=N.parent().css("overflow");if(O!=="visible"){N.parent().css({"overflow":"visible"});}}}}}}};K.prototype._addFieldToFiltersDialog=function(i,j,n){var N,O,Q,U;var W=this._determineVisibility(i.filterItem);if(!this.getShowFilterConfiguration()&&!W){return;}if(i.filterItem.getHiddenFilter()){return;}if(i.control.getWidth){i.width=i.control.getWidth();if(i.control.setWidth){i.control.setWidth("100%");}}N=i.filterItem.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){N.setText(i.filterItem.getLabel());}O=new C({tooltip:this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR")});O.setSelected(i.filterItem.getVisibleInFilterBar());if(i.filterItem.getMandatory()){U=this._checkFilterForValue(n,i.filterItem);if(!U&&i.filterItem.getVisibleInFilterBar()){O.setEnabled(false);}}O.attachSelect(q.proxy(this._selectionChangedInFilterDialog,this,O,i.filterItem));if(this._isNewFilterBarDesign()||!this._isPhone()){N.setLayoutData(new w({span:"L3 M3 S12"}));i.control.setLayoutData(new w({span:"L8 M8 S11"}));O.setLayoutData(new w({span:"L1 M1 S1"}));}else{N.setLayoutData(new w({span:"L3 M3 S12"}));i.control.setLayoutData(new w({span:"L8 M8 S12"}));O.setVisible(false);}Q=new A({label:N,fields:[i.control,O]});Q.setVisible(W);i.formelement=Q;i.checkbox=O;j.addFormElement(Q);};K.prototype._createHeaderAddToFilterBar=function(i){var j,n;if(this._isNewFilterBarDesign()||!this._isPhone()){j=new L({});j.setLayoutData(new w({span:"L10 M10"}));j.addStyleClass("sapUiCompFilterBarAddFilterLabel");this._oAddToFilterBarLabel=j;n=new A({label:j,fields:[]});i.addFormElement(n);}};K.prototype._createFilters=function(){var j=this,n=null,i,N;var O=null,Q,U,W;var X,Y,Z=true,$;this._oClonedVM=null;var _=new E();_.setColumnsL(1);_.setColumnsM(1);var a1=this._createForm(_);a1.addStyleClass("sapUiCompFilterBarDialogForm");if(this._possibleToChangeVariantManagement()&&this._oToolbar){var b1=this._oToolbar.indexOfContent(this._oVariantManagement);if(b1>=0){this._oClonedVM=this._oVariantManagement.clone();this._oClonedVM._setSelectionByKey(this._oVariantManagement.getSelectionKey());this._replaceOnToolbar(this._oVariantManagement,this._oClonedVM);O=new z();this._oVariantManagement.setLayoutData(new w({span:"L10 M10 S12"}));Q=new A({fields:this._oVariantManagement});O.addFormElement(Q);a1.addFormContainer(O);}a1.addStyleClass("sapUiCompFilterBarGroupTitle");}if(this._oBasicSearchField){if(!O){O=new z();a1.addFormContainer(O);}if(!this._isPhone()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();if(this._oToolbar){this._replaceOnToolbar(this._oBasicSearchField,this._oBasicSearchFieldClone);}else{this._addBasicSearchToBasicArea(this._oBasicSearchFieldClone);}}else{if(this.getAdvancedMode()){this._oBasicSearchFieldClone=this._oBasicSearchField.clone();}}if(this._isNewFilterBarDesign()||!this._isPhone()){this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S11",indent:"L0 M3 S0"}));}else{this._oBasicSearchField.setLayoutData(new w({span:"L8 M8 S12"}));}if(this._isPhone()&&this.getAdvancedMode()){Q=new A({fields:[this._oBasicSearchFieldClone]});}else{Q=new A({fields:[this._oBasicSearchField]});}O.addFormElement(Q);}this._ensureFilterLoaded(null);var c1=this._getFiltersWithValues();this._fRegisteredFilterChangeHandlers=function(d1){j._mandatoryFilterChange(d1);};this.attachFilterChange(this._fRegisteredFilterChangeHandlers);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified();}this._oInitialVariant={};q.extend(true,this._oInitialVariant,this._oVariant);for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){if(n===K.INTERNAL_GROUP){N=this._oRb.getText("FILTER_BAR_BASIC_GROUP");}else{N=this._mAdvancedAreaFilter[n].filterItem.getGroupTitle();}Y=new t({text:N});O=new z({title:Y});if(Z){Z=false;this._createHeaderAddToFilterBar(O);}$=0;this._mAdvancedAreaFilter[n].formcontainer=O;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){W=this._mAdvancedAreaFilter[n].items[i];this._addFieldToFiltersDialog(W,O,c1);if(!W.filterItem.getVisible()){$++;}}U=O.getFormElements();if(U&&U.length>0){if(this.getShowFilterConfiguration()){if((n!==K.INTERNAL_GROUP)&&!this.getAdvancedMode()){X=this._createLink(n,Y);if(X){if(this._isPhone()){X.setLayoutData(new w({span:"L8 M8 S12"}));}else{X.setLayoutData(new w({span:"L8 M8 S12",indent:"L3 M3 S0"}));}Q=new A({fields:[X]});this._mAdvancedAreaFilter[n].link=X;O.addFormElement(Q);}if($===U.length){O.setVisible(false);}}}a1.addFormContainer(O);}}}return a1;};K.prototype._replaceOnToolbar=function(i,n){var j;if(this._oToolbar){j=this._oToolbar.indexOfContent(i);if(j>-1){this._oToolbar.insertContent(n,j);this._oToolbar.removeContent(i);}}};K.prototype._recreateBasicAreaContainer=function(U){var n=null,i;var j,N;var O,Q,W;if(this._possibleToChangeVariantManagement()&&this._oToolbar&&this._oClonedVM&&this._oVariantManagement){this._replaceOnToolbar(this._oClonedVM,this._oVariantManagement);this._oClonedVM.destroy();this._oClonedVM=null;}if(!this._isPhone()&&this._oToolbar&&this._oBasicSearchFieldClone&&this._oBasicSearchField){this._replaceOnToolbar(this._oBasicSearchFieldClone,this._oBasicSearchField);this._oBasicSearchFieldClone.destroy();this._oBasicSearchFieldClone=null;}var X=this._oBasicAreaLayout.removeAllContent();if(!U){if(X){var Y=X.length;var Z=0;if(this._isNewFilterBarDesign()){if(this._isPhone()){Z++;}else{Y--;}}for(i=Z;i<Y;i++){if(X[i]!==this._oHintText){X[i].destroy();}}}}if(this._isNewFilterBarDesign()){this._addBasicSearchToBasicArea(this._oBasicSearchField);this._addButtonsToBasicArea();}for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){O=this._mAdvancedAreaFilter[n].items[i].filterItem;if(O.getHiddenFilter()){continue;}W=null;if(U){if(!O.getVisible()||!O.getVisibleInFilterBar()){continue;}Q=this._mAdvancedAreaFilter[n].items[i].container;if(Q){if(Q.$()&&Q.$().width()){W=Q.$().width();}Q.removeAllContent();Q.destroy();}j=this._mAdvancedAreaFilter[n].items[i].control.clone();N=O.getLabelControl(this.getId()).clone();if(this.getConsiderGroupTitle()){O.getLabelControl(this.getId()).setText(O.getLabel());}}else{j=this._mAdvancedAreaFilter[n].items[i].control;N=O.getLabelControl(this.getId());if(this._mAdvancedAreaFilter[n].items[i].width){j.setWidth(this._mAdvancedAreaFilter[n].items[i].width);}}Q=this._addControlToBasicAreaContainer(O,j,N);if(Q){Q.setVisible(O.getVisible()&&O.getVisibleInFilterBar());this._mAdvancedAreaFilter[n].items[i].container=Q;if(U&&W){Q.setWidth(W+"px");}}}}}};K.prototype._searchRequested=function(i){var j=false;if(this.getLiveMode&&this.getLiveMode()){var n=this._retrieveCurrentSelectionSet();j=n.some(function(N){if(N.getValueState&&(N.getValueState()===u.Error)){return true;}return false;});}else{j=!this.search(true);}if(!j){this._oFilterDialog.close();}};K.prototype._closeDialogAndRestoreFilterBar=function(i){this._sSearchCriteriaInFiltersDialog=null;this._oVariant={};i.removeAllFormContainers();this._recreateBasicAreaContainer();this._deleteProperties();this._adaptGroupsTitle();if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null;}if(this.getLiveMode&&this.getLiveMode()){this.search();}this._updateToolbarText();};K.prototype._variantSave=function(i){var j;this._oVariant={};this.fireBeforeVariantSave();if(this._oVariantManagement&&this._oFilterDialog){j=this._oVariantManagement.getSelectionKey();this._oVariant.key=j;this._oVariant.modified=false;this._oVariant.content=this._oVariantManagement.getVariantContent(this,j);}};K.prototype._afterVariantSave=function(i){this.fireAfterVariantSave();};K.prototype._variantSavePressed=function(i){this._bVariantSavePressed=true;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();var n=this._oVariantManagement.getItemByKey(this._oVariantManagement.getSelectionKey());if(!this._oVariantManagement._isIndustrySolutionModeAndVendorLayer()&&((j===this._oVariantManagement.getStandardVariantKey())||(n&&n.getReadOnly&&n.getReadOnly()))){this._oVariantManagement._openSaveAsDialog();}else{this._oVariantManagement._variantSavePressed();}this._bDirtyViaDialog=false;if(this._oInitialVariant&&this._oVariantManagement._getVariantContent){this._oInitialVariant.content=this._oVariantManagement._getVariantContent(this,j);}}};K.prototype._findFirstVisibleGroup=function(){var n=null;for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].formcontainer&&this._mAdvancedAreaFilter[n].formcontainer.getVisible()){return this._mAdvancedAreaFilter[n].formcontainer.getTitle();}}return null;};K.prototype._checkForCollision=function(i,j){var n=this._oFilterDialog.getDomRef("scroll");this._oLabelTextWidth=Math.max(j.width(),this._oLabelTextWidth);if(!this._oLabelTextWidth){return false;}if((this._oLabelTextWidth>0)&&n&&(i.position().left+i.width())>=(n.clientWidth-this._oLabelTextWidth-32)){if(this._oAddToFilterBarLabel){this._oAddToFilterBarLabel.setText("");}return true;}return false;};K.prototype._repositionAddToFilterBarLabel=function(){if(this._isNewFilterBarDesign()||!this._isPhone()){var i=this._findFirstVisibleGroup();if(i&&this._oAddToFilterBarLabel){var j=i.$();if(j){var n=this._oAddToFilterBarLabel.$();if(n){j.css({display:"inline"});if(this._checkForCollision(j,n)){return;}var N=j.offset();var O=n.offset();if(O&&N){O.top=Math.ceil(N.top);n.offset(O);if(!sap.ui.getCore().getConfiguration().getRTL()){n.css({left:"auto"});}}}}}if(this._oAddToFilterBarLabel&&!this._oAddToFilterBarLabel.getText()){this._oAddToFilterBarLabel.setText(this._oRb.getText("FILTER_BAR_SHOW_IN_FILTERBAR"));}}};K.prototype._cancelFilterDialog=function(i){if(i&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled;}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement._setSelectionByKey(this._oInitialVariant.key);}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified);}this._resetFiltersInErrorValueState();this.fireCancel();}};K.prototype._resetFiltersInErrorValueState=function(){var n,i;n=this._retrieveCurrentSelectionSet(true);n.forEach(function(O){if(O.control&&O.control.setValueState&&O.control.getValueState){if(O.control.getValueState()===u.Error){i=O.control.getBinding("value");if(i){if(O.control.setValue){O.control.setValue("");}O.control.setValueState(u.None);}}}});};K.prototype._showFilterDialog=function(){q.sap.require("sap.m.Dialog");var i=this;this._oFilterDialog=new sap.m.Dialog({stretch:D.system.phone});this._oFilterDialog.setParent(this);this._oFilterDialog.addStyleClass("sapUiPopupWithPadding");if(this.$().closest(".sapUiSizeCompact").length>0){this._oFilterDialog.addStyleClass("sapUiSizeCompact");}this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialog");if(!this._isPhone()){this._oFilterDialog.addStyleClass("sapUiCompFilterBarDialogNonPhone");}var j="FILTER_BAR_ADV_FILTERS_DIALOG";if(this._isNewFilterBarDesign()){j="FILTER_BAR_ADAPT_FILTERS_DIALOG";}this._oFilterDialog.setTitle(this._oRb.getText(j));this._oFilterDialog.addStyleClass("sapMH4FontSize");this._oFilterDialog.addStyleClass("sapMH4Style");this._oFilterDialog.setVerticalScrolling(true);var n=new B();this._oFiltersSearchField=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oFiltersSearchField.attachLiveChange(function(O){if(i._oFilterDialog){i._triggerSearchInFilterDialog(O);}});n.addContentRight(this._oFiltersSearchField);this._oFilterDialog.setSubHeader(n);var N=this._createFiltersAndAdaptBasicArea();if(!N){q.sap.log.error("Content for Advanced Filters Dialog could not be created");return;}this._oFilterDialog.addContent(N);this._bOKFiltersDialogTriggered=false;this._bVariantSaveFiltersDialogTriggered=false;this._oFilterDialog._do_not_add_to_basic_area=true;this._oFilterDialog.attachAfterOpen(function(){if(!i._isPhone()){var O=i._oFilterDialog.getDomRef("scroll");if(O){i._oFilterDialog.setContentWidth(O.clientWidth+"px");i._oFilterDialog.setContentHeight(O.clientHeight+"px");}}});this._oFilterDialog.attachBeforeClose(function(){if(!i._bOKFiltersDialogTriggered){i._cancelFilterDialog(i._bVariantSaveFiltersDialogTriggered);}delete i._oFilterDialog._do_not_add_to_basic_area;i._closeDialogAndRestoreFilterBar(N);});this._oFilterDialog.attachAfterClose(function(){i._oBasicAreaLayout.rerender();i._oInitialVariant=null;i._oFilterDialog.destroy();i._oFilterDialog=null;i._showHintText();i.fireFiltersDialogClosed();if(i._isNewFilterBarDesign()){i._fHandleResize();}});this._oFilterDialog.setInitialFocus(this._oFiltersSearchField);this._addFilterDialogButtons(N);this._bDirtyViaDialog=false;this._oFilterDialog.open();};K.prototype.isDialogOpen=function(){return this._oFilterDialog?true:false;};K.prototype._addFilterDialogButtons=function(i){q.sap.require("sap.m.OverflowToolbarPriority");q.sap.require("sap.m.OverflowToolbarLayoutData");var j=this;var n;var N=null,O,Q,U,W;U=new a(this.getId()+"-btnGoFilterDialog",{text:this._oRb.getText("FILTER_BAR_GO"),press:function(){j._bOKFiltersDialogTriggered=true;U.focus();j._searchRequested(i);},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),type:b.Emphasized});this._oFilterDialog.addButton(U);if(!this.getAdvancedMode()){if(this._oVariantManagement&&this._oVariantManagement.getVisible()){this._oVariantManagement._delayedControlCreation();if(this._oVariantManagement.oVariantSave){N=new a(this.getId()+"-btnSaveFilterDialog",{text:this._oRb.getText("VARIANT_MANAGEMENT_SAVE"),enabled:this._oVariantManagement.oVariantSave.getEnabled(),press:function(){j._bVariantSaveFiltersDialogTriggered=true;j._variantSavePressed();},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});n=this._oVariantManagement.getModel("save_enablement");N.setModel(n);N.bindProperty("enabled","/enabled");this._oFilterDialog.addButton(N);}}O=new a(this.getId()+"-btnClearFilterDialog",{text:this._oRb.getText("FILTER_BAR_CLEAR"),visible:this.getShowClearButton(),press:function(){j.clear();},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});this._oFilterDialog.addButton(O);Q=new a(this.getId()+"-btnRestoreFilterDialog",{text:this._oRb.getText("FILTER_BAR_RESTORE"),visible:this.getShowRestoreButton(),press:function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.Low})});if(n){Q.setEnabled(this._oVariantManagement.oVariantSave.getEnabled());Q.setModel(n);Q.bindProperty("enabled","/enabled");}this._oFilterDialog.addButton(Q);W=new a(this.getId()+"-btnCancelFilterDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){j._oFilterDialog.close();},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High})});this._oFilterDialog.addButton(W);}};K.prototype._createButtons=function(i){var j=this;this._oHideShowButton=new a(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),type:b.Transparent,enabled:false});this._oHideShowButton.attachPress(function(){j._toggleHideShow();});i.addContent(this._oHideShowButton);this._oClearButtonOnFB=new a(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),type:b.Transparent,enabled:false});this._oClearButtonOnFB.attachPress(function(){j.clear();});i.addContent(this._oClearButtonOnFB);this._oRestoreButtonOnFB=new a(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),type:b.Transparent,enabled:false});this._oRestoreButtonOnFB.attachPress(function(){j.reset();if(j._oVariantManagement){j._oVariantManagement.currentVariantSetModified(false);}});i.addContent(this._oRestoreButtonOnFB);this._oFiltersButton=new a(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration()||this._isPhone(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:b.Transparent,enabled:false});this._oFiltersButton.attachPress(function(){j._oFiltersButton.focus();j._showFilterDialog();});i.addContent(this._oFiltersButton);this._oSearchButton=new a(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:b.Emphasized});this._oSearchButton.attachPress(function(){j._oSearchButton.focus();j.search();});i.addContent(this._oSearchButton);};K.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false);}this._registerVariantManagement();return this._oVariantManagement;};K.prototype._createToolbar=function(){var i=new h(this.getId()+"-toolbar");var j=this._createVariantLayout();i.addContent(j);i.addContent(new k());this._createButtons(i);i.addStyleClass("sapUiCompFilterBarToolbar");i.addStyleClass("sapUiCompFilterBarToolbarMarker");return i;};K.prototype._replaceVariantManagement=function(i){if(this._oVariantManagement){this._unregisterVariantManagement();if(this._oToolbar&&this._oToolbar.getContent(this._oVariantManagement)){this._oToolbar.removeContent(this._oVariantManagement);}this._oVariantManagement.destroy();}this._oVariantManagement=i;this._registerVariantManagement();this._adaptNewFilterBarDesign();};K.prototype._createBasicAreaLayout=function(){var i=new H({visible:false});i.setAllowWrapping(true);i.addStyleClass("sapUiCompFilterBarWidth100");i.addStyleClass("sapUiCompFilterBarBasicArea");return i;};K.prototype._createAdvancedAreaForm=function(){var i=new E();i.addStyleClass("sapUiCompFilterBarPaddingForm");i.setColumnsL(3);i.setColumnsM(2);var j=new F({editable:true});j.setLayout(i);return j;};K.prototype._addControlToBasicAreaFormContainer=function(i){var j=i.getControl();if(!j){q.sap.log.error("no Control obtained");return null;}var n=i.getLabelControl(this.getId());if(!n){q.sap.log.error("no Label obtained");return null;}this._adaptGroupTitleForFilter(i);return this._addControlToBasicAreaContainer(i,j,n);};K.prototype._addControlToBasicAreaContainer=function(i,j,n){var N=new y();N.setLayoutData(new x({margin:true}));if(j.setWidth){j.setWidth("100%");}if(i&&i._iSpan&&i._iSpan>1){var W=this._calculateISpanWidth(i._iSpan);N.setWidth(W);}else{N.setWidth(this.getFilterContainerWidth());}if(n){if(!n.hasStyleClass("sapUiCompFilterLabel")){n.addStyleClass("sapUiCompFilterLabel");}N.addContent(n);var O=null;if(i&&this.getConditionTypeByKey){O=this.getConditionTypeByKey(i.getName());}if(O){O.setLabel(n);}else if(n.setLabelFor){if(i&&j){n.setLabelFor(j);}else if(j){q.sap.require("sap.ui.core.InvisibleText");var Q=new sap.ui.core.InvisibleText({text:this._oRb.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER")});N.addContent(Q);j.addAriaLabelledBy(Q);}}}N.addContent(j);N.addStyleClass("sapUiCompFilterBarPaddingRight");N.addStyleClass("sapUiCompFilterBarPaddingTop");if(!this.getAdvancedMode()&&(!this._oFilterDialog||(!this._oFilterDialog.hasOwnProperty("_do_not_add_to_basic_area")))){if(i&&i.getVisible()&&i.getVisibleInFilterBar()){if(this._isNewFilterBarDesign()){var U=this._oBasicAreaLayout.getContent();if(this._isPhone()){this._oBasicAreaLayout.addContent(N);}else{this._oBasicAreaLayout.insertContent(N,U.length-1);}}else{this._oBasicAreaLayout.addContent(N);}}}return N;};K.prototype._rerenderAA=function(){this._oAdvancedAreaForm.removeAllFormContainers();var i=this._flattenMap();this._layOutAA(i);};K.prototype._layOutAA=function(i){if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){this._layOutAAMultipleGroup(i);}else{this._layOutAASingleGroup(i);}};K.prototype._layOutAAMultipleGroup=function(n){var i,j,N=0;var O=null;for(i=0;i<n.length;i++){if(n[i].control===null){N++;}}var Q=this._oAdvancedAreaForm.getLayout();if(Q){if(N>=3){Q.setLabelSpanL(5);Q.setLabelSpanM(5);Q.setColumnsL(3);Q.setColumnsM(2);}else if(N===2){Q.setLabelSpanL(4);Q.setLabelSpanM(5);Q.setColumnsL(2);Q.setColumnsM(2);}else if(N===1){Q.setLabelSpanL(4);Q.setLabelSpanM(5);Q.setColumnsL(2);Q.setColumnsM(2);}}for(i=0;i<n.length;i++){if(n[i].control===null){O=new z();if(Object.keys(this._mAdvancedAreaFilter).length>1){O.setTitle(n[i].filterItem.getGroupTitle());}this._oAdvancedAreaForm.addFormContainer(O);j=i+1;while(j<n.length&&(n[j].control)){this._addControlToAdvancedArea(n[j].filterItem,n[j].control,O);j++;}i=j-1;}}if(N===1){this._oAdvancedAreaForm.addFormContainer(new z());}};K.prototype._layOutAASingleGroup=function(j){var i,n,N,O;var Q=j.length-1;var U=Q>2?2:1;if(U>1){N=Math.floor(Q/U);O=((N*U)<Q);for(i=1;i<U;i++){n=i*N;if(O){++n;}if((n+i)<j.length){j.splice(n+i,0,j[0]);}}}this._layOutAAMultipleGroup(j);};K.prototype._flattenMap=function(){var n=null,i;var j=[];var N;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n].items){N=false;for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){var O=this._mAdvancedAreaFilter[n].items[i];if(O.filterItem&&O.filterItem.getVisibleInFilterBar()&&O.filterItem.getVisible()&&!O.filterItem.getHiddenFilter()){if(!N){N=true;j.push({control:null,filterItem:this._mAdvancedAreaFilter[n].filterItem});}j.push({control:O.control,filterItem:O.filterItem});}}}}}return j;};K.prototype._triggerSearchByValue=function(j){var i,n,N;var O;var Q;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._aListItems){var U=0;for(i=this._aListItems.length-1;i>=0;i--){O=this._aListItems[i].getContent();if(O&&(O.length>0)){n=O[0].getText();N=this._aListItems[i].data("quickinfo");if((n.toLowerCase().indexOf(j)>=0||(N&&N.toLowerCase().indexOf(j)>=0))||(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")&&U>0)){Q=true;if(this._aListItems[i].hasStyleClass("sapUiCompFilterBarGroupListItem")){if(!U){Q=false;}}else{U++;}this._aListItems[i].setVisible(Q);}else{this._aListItems[i].setVisible(false);}}}}};K.prototype._triggerSearch=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._triggerSearchByValue(n);};K.prototype._triggerSearchByValueInFilterDialog=function(j){var n=null,i;var N,O;var Q,U;var W;var X;var Y=true;j=j.replace(/^\s+|\s+$/g,"").toLowerCase();if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){Q=this._mAdvancedAreaFilter[n];if(Q&&Q.items){W=0;X=0;for(i=0;i<Q.items.length;i++){if(Q.items[i]&&Q.items[i].filterItem&&Q.items[i].formelement){U=Q.items[i].filterItem;if(U.getHiddenFilter()){continue;}if(U.getVisible()){if(j){N=U.getLabel();O=U.getLabelTooltip();if((N.toLowerCase().indexOf(j)>=0||(O&&O.toLowerCase().indexOf(j)>=0))){if(U.getPartOfCurrentVariant()){Q.items[i].formelement.setVisible(true);}else{++X;}}else{++W;Q.items[i].formelement.setVisible(false);}}else{Q.items[i].formelement.setVisible(U.getVisibleInFilterBar()||U.getPartOfCurrentVariant());if(Q.link&&!Q.link.getVisible()){Q.link.setVisible(true);}}}else{++W;}}}if(Q&&Q.formcontainer){if(W===Q.items.length){Q.formcontainer.setVisible(false);}else{Y=false;Q.formcontainer.setVisible(true);if(Q.link){Q.link.setVisible((j&&(X===0))?false:true);if(j&&(X>0)){this._setLinkTextAndCount(n,Q.link,X);}else{this._setLinkText(n,Q.link);}}}}}}}}if(this._oAddToFilterBarLabel){this._oAddToFilterBarLabel.setVisible(!Y);}};K.prototype._triggerSearchInFilterDialog=function(i){if(!i){return;}var j=i.getParameters();if(!j){return;}var n=j.newValue?j.newValue:"";this._sSearchCriteriaInFiltersDialog=n;this._triggerSearchByValueInFilterDialog(n);};K.prototype._generateListItems=function(j,n){q.sap.require("sap.m.CustomListItem");var i;var N,O;var Q;var U=false;if(this.$().closest(".sapUiSizeCompact").length>0){U=true;}if(j&&this._mAdvancedAreaFilter){O=this._mAdvancedAreaFilter[j];if(O&&O.items){for(i=0;i<O.items.length;i++){var W=O.items[i];if(W&&W.filterItem){if(!W.filterItem.getVisible()||W.filterItem.getHiddenFilter()){continue;}N=new sap.m.CustomListItem();N.setVisible(true);if(!U){N.addStyleClass("sapUiCompFilterBarListItem");}else{N.addStyleClass("sapUiCompFilterBarListItemCompact");}N.data("quickinfo",W.filterItem.getLabelTooltip());W.initialPartOfCurrentVariant=W.filterItem.getPartOfCurrentVariant();W.initialVisibleInFilterBar=W.filterItem.getVisibleInFilterBar();N.data('item',W);Q=new L({text:W.filterItem.getLabel(),tooltip:W.filterItem.getLabelTooltip()});N.addContent(Q);n.addItem(N);if(W.filterItem.getPartOfCurrentVariant()){n.setSelectedItem(N);}if(W.filterItem.getMandatory()&&W.checkbox&&!W.checkbox.getEnabled()){N.getModeControl().setEnabled(false);}}}}}var X=this;n.attachSelectionChange(function(Y){if(Y){var Z=Y.getParameters();if(Z){var N=Z.listItem;if(N){var $=N.getModeControl();var W=N.data('item');X._selectionChangedInAddFiltersDialog($,W);}}}});};K.prototype._rerenderItem=function(i){var j;if(i){j=i.filterItem.getVisible()&&i.filterItem.getVisibleInFilterBar();if(i.container){i.container.setVisible(j);if(j){this._addContainer(i);}}if(i.formelement){i.formelement.setVisible(i.filterItem.getVisible()&&(i.filterItem.getVisibleInFilterBar()||i.filterItem.getPartOfCurrentVariant()));if(i.checkbox){i.checkbox.setSelected(i.filterItem.getVisibleInFilterBar());}}}};K.prototype._rerenderFilters=function(){var i;var n=null;var j=null;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];this._rerenderItem(j);}}}}this._updateToolbarText();};K.prototype.rerenderFilters=function(){this._rerenderFilters();};K.prototype._closeAddRemoveFiltersDialog=function(i,j){if(i&&j){if(this._sSearchCriteriaInFiltersDialog&&this._oFilterDialog){this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);}else{this._setLinkText(i,j);}}};K.prototype._cancelAddRemoveFiltersDialog=function(j){var i;var n;if(j&&this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[j]&&this._mAdvancedAreaFilter[j].items){for(i=0;i<this._mAdvancedAreaFilter[j].items.length;i++){n=this._mAdvancedAreaFilter[j].items[i];if((n.initialPartOfCurrentVariant!==undefined||n.initialVisibleInFilterBar!==undefined)&&n.filterItem){if(n.filterItem.getHiddenFilter()){continue;}if((n.initialPartOfCurrentVariant!==undefined)&&(n.filterItem.getPartOfCurrentVariant()!==n.initialPartOfCurrentVariant)){n.filterItem.setPartOfCurrentVariant(n.initialPartOfCurrentVariant);this._notifyAboutChangedFilters(n.initialPartOfCurrentVariant,n.control);}if((n.initialVisibleInFilterBar!==undefined)&&(n.filterItem.getVisibleInFilterBar()!==n.initialVisibleInFilterBar)){n.filterItem.setVisibleInFilterBar(n.initialVisibleInFilterBar);}}}}if(this._oVariantManagement&&(this._oVariant.modified2!==undefined)){this._oVariantManagement.currentVariantSetModified(this._oVariant.modified2);}};K.prototype._createAddRemoveFiltersDialog=function(j,n){q.sap.require("sap.m.Dialog");q.sap.require("sap.m.ListMode");var i,N=this;if(!j){return;}this._oDialog=new sap.m.Dialog({stretch:D.system.phone});this._oDialog.addStyleClass("sapUiPopupWithPadding");this._oDialog.addStyleClass("sapUiCompAddRemoveFilterDialog");if(this.$().closest(".sapUiSizeCompact").length>0){this._oDialog.addStyleClass("sapUiSizeCompact");}this._oDialog.setTitle(this._oRb.getText("SELECT_FILTER_FIELDS"));this._oDialog.addStyleClass("sapMH4FontSize");this._oDialog.addStyleClass("sapMH4Style");this._oDialog.setVerticalScrolling(true);var O=new B();var Q=new S({placeholder:this._oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=Q;Q.attachLiveChange(function(Y){N._triggerSearch(Y);});O.addContentRight(Q);this._oDialog.setSubHeader(O);var U=new e({mode:sap.m.ListMode.MultiSelect});U.setShowSeparators(f.None);this._oDialog.addContent(U);this._generateListItems(j,U);this._aListItems=U.getItems();for(i=0;i<this._aListItems.length;i++){U.addItem(this._aListItems[i]);}if(this._oVariant&&this._oVariantManagement){this._oVariant.modified2=this._oVariantManagement.currentVariantGetModified();}this._bOKButtonAddRemoveFilterDialogTriggered=false;var W=new a(this.getId()+"-btnOKAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_OK")});W.attachPress(function(){N._bOKButtonAddRemoveFilterDialogTriggered=true;N._oDialog.close();});this._oDialog.addAggregation("buttons",W);this._oDialog.setInitialFocus(this._oSearchField);if(this._sSearchCriteriaInFiltersDialog){this._oSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValue(this._sSearchCriteriaInFiltersDialog);}var X=new a(this.getId()+"-btnCancelAddRemoveDialog",{text:this._oRb.getText("FILTER_BAR_CANCEL"),press:function(){N._oDialog.close();}});this._oDialog.addAggregation("buttons",X);this._oDialog.attachBeforeClose(function(){if(!N._bOKButtonAddRemoveFilterDialogTriggered){N._cancelAddRemoveFiltersDialog(j);}N.rerenderFilters();N._closeAddRemoveFiltersDialog(j,n);});this._oDialog.attachAfterClose(function(){this._aListItems=null;N._oDialog.destroy();N._oDialog=null;});this._oDialog.open();};K.prototype._selectionChangedInAddFiltersDialog=function(i,j){var n=i.getSelected();if(!n&&j.filterItem.getMandatory()&&!j.checkbox.getEnabled()){i.setSelected(true);return;}j.filterItem.setPartOfCurrentVariant(n);j.filterItem.setVisibleInFilterBar(n);this._notifyAboutChangedFilters(n,j.control);};K.prototype._setTriggerFilterChangeState=function(i){this._triggerFilterChangeState=i;};K.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState;};K.prototype._setConsiderFilterChanges=function(i){this._filterChangeSemaphore=i;};K.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore;};K.prototype.fireFilterChange=function(i){this._updateToolbarText();if(!this._getTriggerFilterChangeState()){return;}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&this._oVariantManagement.getEnabled()){this._oVariantManagement.currentVariantSetModified(true);}if(this._oFilterDialog&&!(this._oFilterDialog.isOpen())){return;}this._bDirtyViaDialog=true;this.fireEvent("filterChange",i);if(this._isNewFilterBarDesign()){}};K.prototype._notifyAboutChangedFilters=function(i,j){var O;if(i){O={"added":j};}else{O={"deleted":j};}this.fireFilterChange(O);};K.prototype._determineVariantFiltersInfo=function(j,N){var i;var n=null,O,Q;var U=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){O=this._mAdvancedAreaFilter[n].items[i];if(j||O.filterItem.getVisible()){Q={group:O.filterItem.getGroupName(),name:O.filterItem.getName(),partOfCurrentVariant:O.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:O.filterItem.getVisibleInFilterBar(),visible:O.filterItem.getVisible()};if(N||this._considerFilter(Q)){U.push(Q);}}}}}}}return U;};K.prototype.mergeVariant=function(i,j){var n={};q.extend(true,n,j);n.filterbar=[];n.filterBarVariant={};q.extend(true,n.filterbar,i.filterbar);q.extend(true,n.filterBarVariant,i.filterBarVariant);if(j&&j.version==="V2"){n.filterbar=this._mergeVariantFields(n.filterbar,j.filterbar);n.filterBarVariant=j.filterBarVariant;}return n;};K.prototype._mergeVariantFields=function(j,n){var i;n.forEach(function(N){for(i=0;i<j.length;i++){if((j[i].group===N.group)&&(j[i].name===N.name)){j.splice(i,1);break;}}});return j.concat(n);};K.prototype._isUi2Mode=function(){if(this._oVariantManagement instanceof p){return true;}return false;};K.prototype._isDeltaHandling=function(){if(this._isUi2Mode()){return false;}return this.getDeltaVariantMode();};K.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this);};K.prototype._considerFilter=function(j){if(!this._isDeltaHandling()){return true;}var n=null;var N=this._getStandardVariant();if(N&&N.filterbar){for(var i=0;i<N.filterbar.length;i++){if((N.filterbar[i].group===j.group)&&(N.filterbar[i].name===j.name)){n=N.filterbar[i];break;}}}if(!n){if(!j.partOfCurrentVariant){return false;}return true;}if((n.partOfCurrentVariant!==j.partOfCurrentVariant)||(n.visibleInFilterBar!==j.visibleInFilterBar)||(n.visible!==j.visible)){return true;}return false;};K.prototype._addControlToAdvancedArea=function(i,j,n){var N=new A({label:i.getLabelControl(this.getId()),fields:[(j!==null)?j:new T()]});n.addFormElement(N);};K.prototype._determineVisibility=function(i){var j=false;if(i){j=i.getVisible()&&(i.getVisibleInFilterBar()||i.getPartOfCurrentVariant());j=j&&!i.getHiddenFilter();}return j;};K.prototype._retrieveVisibleAdvancedItems=function(){var i,n=null,j;var N=[];if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){if(this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j){if(this._determineVisibility(j.filterItem)){N.push(j);}}}}}}}return N;};K.prototype._retrieveCurrentSelectionSet=function(W){var i,j,O,n=[];var N=this._retrieveVisibleAdvancedItems();for(i=0;i<N.length;i++){j=N[i];if(j.control&&j.filterItem&&!j.filterItem._isParameter()){if(W){O={name:N[i].filterItem.getName(),control:N[i].control};}else{O=N[i].control;}n.push(O);}}return n;};K.prototype.search=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet();this.fireSearch(i);return true;};K.prototype.clear=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet();this._clearErrorState();this.fireClear(i);this._updateToolbarText();};K.prototype.reset=function(){var i={};i.selectionSet=this._retrieveCurrentSelectionSet();this.fireReset(i);this._resetVariant();};K.prototype._resetVariant=function(){var i=null;if(this._oVariantManagement){var j=this._oVariantManagement.getSelectionKey();if(j){i=this._oVariantManagement.getVariantContent(this,j);if(this._oVariant){this._oVariant.content=i;this._oVariant.modified=false;}if(i){this.applyVariant(i,"RESET");}}}this._resetFilterBarSearch();};K.prototype._resetFilterBarSearch=function(){this._sSearchCriteriaInFiltersDialog="";this._oFiltersSearchField.setValue(this._sSearchCriteriaInFiltersDialog);this._triggerSearchByValueInFilterDialog(this._sSearchCriteriaInFiltersDialog);};K.prototype._applyVariant=function(i,j,n){var N,O=null,Q,U=false;if(i){if(n){Q=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false);}this._setConsiderFilterChanges(false);N=i.filterBarVariant;O=i.filterbar;this._ensureFilterLoaded(O);this._reapplyVisibility(O);this._applyVariantFields(N);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(""||i.basicSearch);}if(i.executeOnSelection){U=i.executeOnSelection;}this.fireAfterVariantLoad(j,U);this._setConsiderFilterChanges(true);this._updateToolbarText();if(U){this.search();}else{this._clearErrorState();}if(n){this._setTriggerFilterChangeState(Q);}}};K.prototype._fetchVariantFiltersData=function(){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData();}catch(i){q.sap.log.error("callback for fetching data throws an exception");}}else{q.sap.log.warning("no callback for fetch data supplied");}return null;};K.prototype._applyVariantFields=function(j){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(j);}catch(i){q.sap.log.error("callback for applying data throws an exception");}}else{q.sap.log.warning("no callback for appy data supplied");}};K.prototype._isStandardVariant=function(){var i=this.getCurrentVariantId();if(!i){return true;}if(this._oVariantManagement){if((i===this._oVariantManagement.getStandardVariantKey())){return true;}if(this._oVariantManagement._oStandardVariant===null){return true;}}return false;};K.prototype.fetchVariant=function(){var i;var j={};if(this._isDeltaHandling()){if(!this._isStandardVariant()){j.version="V2";}}this.fireBeforeVariantFetch();i=this._determineVariantFiltersInfo(true,!j.version);j.filterbar=(!i)?[]:i;j.filterBarVariant=this._fetchVariantFiltersData();if(this._oBasicSearchField&&this._oBasicSearchField.getValue){j.basicSearch=this._oBasicSearchField.getValue();}if(this._oVariant&&this._oVariant.content){this._oVariant.content=j;}return j;};K.prototype.applyVariant=function(i,j,n){if(i.version==="V2"){i=this.mergeVariant(this._getStandardVariant(),i,j);}this._applyVariant(i,j,n);if(n&&this._isNewFilterBarDesign()){}};K.prototype.determineMandatoryFilterItems=function(){var i;var j=[];var n=this._retrieveVisibleAdvancedItems();for(i=0;i<n.length;i++){if(n[i].filterItem.getMandatory()===true){if(n[i].control){j.push(n[i].filterItem);}}}return j;};K.prototype.determineControlByFilterItem=function(j,N){var i,n=null;var O,Q;if(!j||(!N&&j._isParameter())){return null;}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){O=this._aBasicAreaSelection[i];if(j===O.filterItem){return O.control;}}}if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){Q=this._mAdvancedAreaFilter[n];if(Q&&Q.items){for(i=0;i<Q.items.length;i++){O=Q.items[i];if((N||!O.filterItem._isParameter())&&(j===O.filterItem)){return O.control;}}}}}}return null;};K.prototype.determineControlByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem&&!j.filterItem._isParameter()){return j.control;}return null;};K.prototype.determineLabelByName=function(n,i){var j=this._determineEnsuredItemByName(n,i);if(j&&j.filterItem){return j.filterItem._oLabel;}return null;};K.prototype._determineEnsuredItemByName=function(n,i){if(!i){i=this._determineGroupNameByName(n);}this._ensureFilterLoaded([{name:n,group:i}]);return this._determineItemByName(n,i);};K.prototype._determineGroupNameByName=function(n){if(this._aFields){for(var i=0;i<this._aFields.length;i++){if(this._aFields[i].fieldName===n){return this._aFields[i].groupName;}}}var j=this.determineFilterItemByName(n);if(j){var N=j.getGroupName();if(N!==K.INTERNAL_GROUP){return N;}}return null;};K.prototype._determineItemByName=function(n,j){var i;var N,O;var Q=j;if(!n){return null;}if(!Q){Q=K.INTERNAL_GROUP;}if(this._mAdvancedAreaFilter){O=this._mAdvancedAreaFilter[Q];if(O&&O.items){for(i=0;i<O.items.length;i++){N=O.items[i];if(N&&N.filterItem&&(N.filterItem.getName()===n)){return N;}}}}return null;};K.prototype.determineFilterItemByName=function(N){var n,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){i=this._determineItemByName(N,n);if(i){return i.filterItem;}}}return null;};K.prototype._determineByControl=function(j){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var N=this._mAdvancedAreaFilter[n];if(N&&N.items){for(i=0;i<N.items.length;i++){if(N.items[i]&&N.items[i].control===j){return N.items[i];}}}}}}return null;};K.prototype._deleteProperties=function(){var n=null,i;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n){var j=this._mAdvancedAreaFilter[n];if(j&&j.items){if(j.formcontainer){delete j.formcontainer;}if(j.link){delete j.link;}for(i=0;i<j.items.length;i++){if(j.items[i]&&j.items[i].checkbox){delete j.items[i].checkbox;}if(j.items[i]&&j.items[i].formelement){delete j.items[i].formelement;}}}}}}};K.prototype._fHandleResize=function(i){if(!this._isPhone()&&this._oFilterDialog&&this._oFilterDialog.isOpen()&&this._mAdvancedAreaFilter){this._repositionAddToFilterBarLabel();}this._checkAndAdaptFilterWidth();};K.prototype._checkAndAdaptFilterWidth=function(){if(this._isNewFilterBarDesign()&&!this._oFilterDialog){this._adaptFilterWidth();}};K.prototype._adaptFilterWidth=function(){var i;if(!this._oBasicAreaLayout){return;}if(!this._bIsInitialized){return;}var j=this._oBasicAreaLayout.getContent();if(!j){return;}for(i=j.length-1;i>=0;i--){if(!j[i].getVisible()){j.splice(i,1);}}if(j.length<1){return;}var n=this._oBasicAreaLayout.$().width()-1;var N,O=this._calculateRequiredWidthAndResetToInitialWidth(j);if(O>n){N=0;}else{N=j[j.length-1].$().width()+16;}var Q=0,U=j.length-1;if(this._isPhone()){Q++;U++;}var W=0;for(i=Q;i<U;i++){if((N+j[i].$().width()+16)>n){break;}N+=j[i].$().width()+16;W++;}var X=Math.floor((n-N)/W);if((W===1)&&(O<n)){X=Math.floor(X/3);}if(X>0){this._increaseFilterWidth(j,X,n);}};K.prototype._calculateRequiredWidthAndResetToInitialWidth=function(j){var i,W,n,N=j[j.length-1].$().width()+16;var O=this._retrieveVisibleAdvancedItems();if(this._isPhone()){N=j[0].$().width()+16;}else{N=j[j.length-1].$().width()+16;}if(this._oBasicSearchFieldContainer&&this._oBasicSearchFieldContainer.$()){this._oBasicSearchFieldContainer.$().width(this.getFilterContainerWidth());this._oBasicSearchFieldContainer.$().css({"min-width":this.getFilterContainerWidth()});this._oBasicSearchFieldContainer.$().css({"max-width":this._oBasicSearchFieldContainer.$().width()*1.5});N+=this._oBasicSearchFieldContainer.$().width();N+=16;}for(i=0;i<O.length;i++){if(O[i].filterItem&&O[i].filterItem.getVisible()&&O[i].filterItem.getVisibleInFilterBar()){var Q=O[i].container;if(Q&&Q.$()){if(O[i].filterWidth){n=Q.$().width();if(n!==O[i].filterWidth){Q.$().width(O[i].filterWidth);n=O[i].filterWidth;}}else{if(O[i].filterItem&&O[i].filterItem._iSpan){W=this._calculateISpanWidth(O[i].filterItem._iSpan);Q.$().width(W);}else{Q.$().width(this.getFilterContainerWidth());}n=Q.$().width();O[i].filterWidth=n;}Q.$().css({"min-width":n});Q.$().css({"max-width":n*1.5});N+=n;N+=16;}}}return N;};K.prototype._calculateISpanWidth=function(n){var W=parseInt(this.getFilterContainerWidth(),10),U=this.getFilterContainerWidth().replace(""+W,"");W=W*n+1;return(W+U);};K.prototype._increaseFilterWidth=function(j,n,N){var O,Q=0,U=j.length-1;if(this._isPhone()){Q++;U++;}for(var i=Q;i<U;i++){O=j[i].$().width()+n;j[i].$().width(O);}};K.prototype.onAfterRendering=function(i){if(!this._bDoItOnce&&!(this._isPhone()||this._isTablet())){this._bDoItOnce=true;if(this._oHintText&&this._oHintText.getVisible()){this.setFilterBarExpanded(false);}}this._checkAndAdaptFilterWidth();};K.prototype._destroyLazyFilterControl=function(){var j,i;if(this._aFields&&(this._aFields.length>0)){if(this._aFields&&this._aFields.length>0){for(j=0;j<this._aFields.length;j++){i=this._aFields[j];if(i.factory){if(i.control){i.control.destroy();}}}}}};K.prototype._destroyNonVisibleFilterControl=function(){var i,n,j;if(this._mAdvancedAreaFilter){for(n in this._mAdvancedAreaFilter){if(n&&this._mAdvancedAreaFilter[n]&&this._mAdvancedAreaFilter[n].items){for(i=0;i<this._mAdvancedAreaFilter[n].items.length;i++){j=this._mAdvancedAreaFilter[n].items[i];if(j&&j.container){if(this._oBasicAreaLayout&&(this._oBasicAreaLayout.indexOfContent(j.container)<0)){if(j.control&&!j.bDestroyed){j.control.destroy();j.bDestroyed=true;}}}}}}}};K.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl();this._destroyNonVisibleFilterControl();}};K.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this);}};K.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null;}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if(!this.getUseToolbar()&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy();}}};K.prototype.destroy=function(){sap.ui.core.ResizeHandler.deregister(this._hResizeListener);this._hResizeListener=null;this._unregisterVariantManagement();this._destroyFilterControls();G.prototype.destroy.apply(this,arguments);if(this._oDialog){this._oDialog.destroy();this._oDialog=null;}if(this._oFilterDialog){this._oFilterDialog.destroy();this._oFilterDialog=null;}this._aFields=null;this._oHintText=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oBasicAreaLayout=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oSearchButton=null;this._oFiltersButton=null;this._oHideShowButton=null;this._oClearButtonOnFB=null;this._oRestoreButtonOnFB=null;this._oAddToFilterBarLabel=null;this._oBasicSearchField=null;this._oBasicSearchFieldContainer=null;};return K;},true);
