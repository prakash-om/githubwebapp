/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/ui/comp/config/condition/Type','sap/m/Input','sap/m/DateRangeSelection','sap/m/DatePicker','sap/m/Text','sap/m/Select','sap/ui/core/date/UniversalDate','sap/ui/core/Locale','sap/ui/core/LocaleData','sap/ui/model/odata/Filter'],function(q,T,I,D,a,b,S,U,L,c,F){"use strict";sap.ui.model.type.Integer.extend("sap.ui.model.type.NullableInteger",{parseValue:function(v,i){switch(this.getPrimitiveType(i)){case"string":if(v===""){return null;}}return sap.ui.model.type.Integer.prototype.parseValue.apply(this,arguments);}});var d=T.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(f,o,e){T.apply(this,[f,o,e]);this.oDateFormat=o&&o._oDateFormatSettings?o._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;}});d.prototype.applySettings=function(s){T.prototype.applySettings.apply(this,arguments);if(s&&s.ignoreTime){this._bIgnoreTime=s.ignoreTime;}};d.setStartTime=function(o){if(o instanceof Date){o=new U(o);}if(!o){o=new U();}o.setHours(0);o.setMinutes(0);o.setSeconds(0);o.setMilliseconds(0);return o;};d.setEndTime=function(o){o=d.toUniversalDate(o);o.setHours(23);o.setMinutes(59);o.setSeconds(59);o.setMilliseconds(999);return o;};d.toUniversalDate=function(o){if(o instanceof Date){o=new U(o);}if(!o){o=new U();}return o;};d.getWeekStartDate=function(u){var l=new L(sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale().toString()),o=c.getInstance(l),f=o.getFirstDayOfWeek();if(!u){u=new U();}u.setDate(u.getDate()-u.getDay()+f);return d.setStartTime(u);};d.getMonthStartDate=function(u){if(!u){u=new U();}u.setDate(1);return d.setStartTime(u);};d.getQuarterStartDate=function(u){if(!u){u=new U();}u.setMonth(3*Math.floor(u.getMonth()/3));u.setDate(1);return d.setStartTime(u);};d.getYearStartDate=function(u){if(!u){u=new U();}u.setMonth(0);u.setDate(1);return d.setStartTime(u);};d.getDateRange=function(v,t,u,C,i){if(u===true){C=true;u=null;}if(!u){u=new U();}else if(!(u instanceof U)){throw new Error("Date must be a UniversalDate object "+this);}var s=new U(),e;if(u){s.getJSDate().setTime(u.getTime());s=d.setStartTime(s);}if(v!==0&&!isNaN(v)){if(t==="DAY"){if(i&&v>0){s.setDate(s.getDate()+1);}e=new U(s);e.setDate(s.getDate()+v);}else if(t==="WEEK"){if(C){s=d.getWeekStartDate(s);}if(i&&v>0){s.setDate(s.getDate()+7);}e=new U(s);e.setDate(s.getDate()+(v*7));}else if(t==="MONTH"){if(C){s=d.getMonthStartDate(s);}if(i&&v>0){s.setMonth(s.getMonth()+1);}e=new U(s);e.setMonth(s.getMonth()+v);}else if(t==="QUARTER"){if(C){s=d.getQuarterStartDate(s);}if(i&&v>0){s.setMonth(s.getMonth()+3);}e=new U(s);e.setMonth(s.getMonth()+(v*3));}else if(t==="YEAR"){if(C){s=d.getYearStartDate(s);}if(i&&v>0){s.setFullYear(s.getFullYear()+1);}e=new U(s);e.setFullYear(s.getFullYear()+v);}}if(!e){return[];}if(e.getTime()<s.getTime()){e=[s,s=e][0];}e.setDate(e.getDate()-1);return[d.setStartTime(s),d.setEndTime(e)];};d.getTextField=function(i,e){if(e){return new b(T._createStableId(i,"text"),{text:"{path: '$smartEntityFilter>value1', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:i.oDateFormat.style,pattern:i.oDateFormat.pattern})+"} - {path: '$smartEntityFilter>value2', type:'sap.ui.model.type.Date', formatOptions:"+JSON.stringify({style:i.oDateFormat.style,pattern:i.oDateFormat.pattern})+"}"});}return new b(T._createStableId(i,"text"),{text:{path:'$smartEntityFilter>value1',type:'sap.ui.model.type.Date',formatOptions:{style:i.oDateFormat.style,pattern:i.oDateFormat.pattern}}});};d.getIntField=function(i){return new I(T._createStableId(i,"field"),{width:"7rem",ariaLabelledBy:i.oOperationSelect||null,value:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.NullableInteger"},textAlign:"End",type:"Number",valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}}});};d.getDescriptionText=function(t,s,r,i){return new b(T._createStableId(i,"descripttext"),{wrapping:false,text:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer",formatter:function(){if(this.getBinding("text").getValue()===1){return T.getTranslatedText(t,r);}else{return T.getTranslatedText(s||t,r);}}}});};d.ControlFactory=function(i,r,o){if(o.type==="range"){var C=d.getTextField(i,o.display!=="start");C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);return;}if(o.type==="int"){var C=d.getIntField(i);C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);C.setWidth(i.sWidth);if(o.descriptionTextKeys){C.setWidth("100%");var t=d.getDescriptionText(o.descriptionTextKeys[0],o.descriptionTextKeys[1],null,i);t.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(t);t.setWidth("auto");C.addAriaLabelledBy(t);}}};d.getFixedRangeOperation=function(k,t,C,e){return{key:k,textKey:t,category:C,defaultValues:e||null,type:"range",display:"range",getControls:d.ControlFactory};};d.Operations={DATERANGE:{key:"DATERANGE",textKey:"CONDITION_DATERANGETYPE_DATERANGE",category:"DYNAMIC.DATERANGE",defaultOperation:true,defaultValues:[null,null],value1:null,value2:null,getControls:function(i,r){var C=new D(T._createStableId(i,"field"),{ariaLabelledBy:i.oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},secondDateValue:{path:"$smartEntityFilter>value2"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}},change:function(e){var v=e.getParameter("valid");if(v){this.fireValidationSuccess({element:this},false,true);}else{this.fireValidationError({element:this},false,true);}}});C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);}},FROM:{key:"FROM",textKey:"CONDITION_DATERANGETYPE_FROM",category:"DYNAMIC.DATE",defaultValues:[null],value1:null,getControls:function(i,r){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i.oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}}});C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);}},TO:{key:"TO",textKey:"CONDITION_DATERANGETYPE_TO",category:"DYNAMIC.DATE",defaultValues:[null],value1:null,getControls:function(i,r,o){var C=new a(T._createStableId(i,"field"),{ariaLabelledBy:i.oOperationSelect||null,dateValue:{path:"$smartEntityFilter>value1"},displayFormat:i.oDateFormat.style||i.oDateFormat.pattern||"",valueState:{path:"$smartEntityFilter>/inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return sap.ui.core.ValueState.Error;}else{return sap.ui.core.ValueState.None;}}}});C.addStyleClass("sapUiCompFilterBarCTPaddingLeft");r.push(C);}},LASTDAYS:{key:"LASTDAYS",textKey:"CONDITION_DATERANGETYPE_LASTDAYS",category:"DYNAMIC.DATE.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],getControls:d.ControlFactory},LASTWEEKS:{key:"LASTWEEKS",textKey:"CONDITION_DATERANGETYPE_LASTWEEKS",category:"DYNAMIC.WEEK.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],getControls:d.ControlFactory},LASTMONTHS:{key:"LASTMONTHS",textKey:"CONDITION_DATERANGETYPE_LASTMONTHS",category:"DYNAMIC.MONTH.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],getControls:d.ControlFactory},LASTQUARTERS:{key:"LASTQUARTERS",textKey:"CONDITION_DATERANGETYPE_LASTQUARTERS",category:"DYNAMIC.QUARTER.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],getControls:d.ControlFactory},LASTYEARS:{key:"LASTYEARS",textKey:"CONDITION_DATERANGETYPE_LASTYEARS",category:"DYNAMIC.YEAR.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],getControls:d.ControlFactory},NEXTDAYS:{key:"NEXTDAYS",textKey:"CONDITION_DATERANGETYPE_NEXTDAYS",category:"DYNAMIC.DATE.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_DAY","CONDITION_DATERANGETYPE_MULTIPLE_DAYS"],getControls:d.ControlFactory},NEXTWEEKS:{key:"NEXTWEEKS",textKey:"CONDITION_DATERANGETYPE_NEXTWEEKS",category:"DYNAMIC.WEEK.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_WEEK","CONDITION_DATERANGETYPE_MULTIPLE_WEEKS"],getControls:d.ControlFactory},NEXTMONTHS:{key:"NEXTMONTHS",textKey:"CONDITION_DATERANGETYPE_NEXTMONTHS",category:"DYNAMIC.MONTH.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_MONTH","CONDITION_DATERANGETYPE_MULTIPLE_MONTHS"],getControls:d.ControlFactory},NEXTQUARTERS:{key:"NEXTQUARTERS",textKey:"CONDITION_DATERANGETYPE_NEXTQUARTERS",category:"DYNAMIC.QUARTER.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_QUARTER","CONDITION_DATERANGETYPE_MULTIPLE_QUARTERS"],getControls:d.ControlFactory},NEXTYEARS:{key:"NEXTYEARS",textKey:"CONDITION_DATERANGETYPE_NEXTYEARS",category:"DYNAMIC.YEAR.INT",defaultValues:[1],value1:null,type:"int",descriptionTextKeys:["CONDITION_DATERANGETYPE_SINGLE_YEAR","CONDITION_DATERANGETYPE_MULTIPLE_YEARS"],getControls:d.ControlFactory},SPECIFICMONTH:{key:"SPECIFICMONTH",textKey:"CONDITION_DATERANGETYPE_SPECIFICMONTH",category:"DYNAMIC.MONTH",defaultValues:function(){var o=new U();return[o.getMonth()];},value1:null,getControls:function(i,r,o){var s=new S(T._createStableId(i,"field"),{ariaLabelledBy:i.oOperationSelect||null,width:"12rem",selectedKey:{path:"$smartEntityFilter>value1",type:"sap.ui.model.type.Integer"}});s.bindAggregation("items",{path:"$smartEntityFilter>/currentoperation/valueList",template:new sap.ui.core.ListItem({text:{path:"$smartEntityFilter>text"},key:{path:"$smartEntityFilter>key"}})});s.addStyleClass("sapUiCompFilterBarCTMarginLeft");r.push(s);},getValueList:function(){var o=new U(),m=[],f=sap.ui.core.format.DateFormat.getDateInstance({pattern:"MMMM"});o.setDate(15);o.setMonth(0);for(var i=0;i<12;i++){m.push({text:f.format(o),key:i});o.setMonth(o.getMonth()+1);}return m;}},TODAY:{key:"TODAY",textKey:"CONDITION_DATERANGETYPE_TODAY",category:"FIXED.DATE",defaultValues:function(){return d.getDateRange(1,"DAY",true);},type:"range",display:"start",getControls:d.ControlFactory},THISWEEK:d.getFixedRangeOperation("THISWEEK","CONDITION_DATERANGETYPE_THISWEEK","FIXED.WEEK",function(){return d.getDateRange(1,"WEEK",true);}),LASTWEEK:d.getFixedRangeOperation("LASTWEEK","CONDITION_DATERANGETYPE_LASTWEEK","FIXED.WEEK",function(){return d.getDateRange(-1,"WEEK",true);}),LAST2WEEKS:d.getFixedRangeOperation("LAST2WEEKS","CONDITION_DATERANGETYPE_LAST2WEEKS","FIXED.WEEK",function(){return d.getDateRange(-2,"WEEK",true);}),LAST3WEEKS:d.getFixedRangeOperation("LAST3WEEKS","CONDITION_DATERANGETYPE_LAST3WEEKS","FIXED.WEEK",function(){return d.getDateRange(-3,"WEEK",true);}),LAST4WEEKS:d.getFixedRangeOperation("LAST4WEEKS","CONDITION_DATERANGETYPE_LAST4WEEKS","FIXED.WEEK",function(){return d.getDateRange(-4,"WEEK",true);}),LAST5WEEKS:d.getFixedRangeOperation("LAST5WEEKS","CONDITION_DATERANGETYPE_LAST5WEEKS","FIXED.WEEK",function(){return d.getDateRange(-5,"WEEK",true);}),NEXTWEEK:d.getFixedRangeOperation("NEXTWEEK","CONDITION_DATERANGETYPE_NEXTWEEK","FIXED.WEEK",function(){return d.getDateRange(1,"WEEK",true,true,true);}),NEXT2WEEKS:d.getFixedRangeOperation("NEXT2WEEKS","CONDITION_DATERANGETYPE_NEXT2WEEKS","FIXED.WEEK",function(){return d.getDateRange(2,"WEEK",true,true,true);}),NEXT3WEEKS:d.getFixedRangeOperation("NEXT3WEEKS","CONDITION_DATERANGETYPE_NEXT3WEEKS","FIXED.WEEK",function(){return d.getDateRange(3,"WEEK",true,true,true);}),NEXT4WEEKS:d.getFixedRangeOperation("NEXT4WEEKS","CONDITION_DATERANGETYPE_NEXT4WEEKS","FIXED.WEEK",function(){return d.getDateRange(4,"WEEK",true,true,true);}),NEXT5WEEKS:d.getFixedRangeOperation("NEXT5WEEKS","CONDITION_DATERANGETYPE_NEXT5WEEKS","FIXED.WEEK",function(){return d.getDateRange(5,"WEEK",true,true,true);}),THISMONTH:d.getFixedRangeOperation("THISMONTH","CONDITION_DATERANGETYPE_THISMONTH","FIXED.MONTH",function(){return d.getDateRange(1,"MONTH",true);}),LASTMONTH:d.getFixedRangeOperation("LASTMONTH","CONDITION_DATERANGETYPE_LASTMONTH","FIXED.MONTH",function(){return d.getDateRange(-1,"MONTH",true);}),NEXTMONTH:d.getFixedRangeOperation("NEXTMONTH","CONDITION_DATERANGETYPE_NEXTMONTH","FIXED.MONTH",function(){return d.getDateRange(1,"MONTH",true,true,true);}),THISQUARTER:d.getFixedRangeOperation("THISQUARTER","CONDITION_DATERANGETYPE_THISQUARTER","FIXED.QUARTER",function(){return d.getDateRange(1,"QUARTER",true);}),LASTQUARTER:d.getFixedRangeOperation("LASTQUARTER","CONDITION_DATERANGETYPE_LASTQUARTER","FIXED.QUARTER",function(){return d.getDateRange(-1,"QUARTER",true);}),NEXTQUARTER:d.getFixedRangeOperation("NEXTQUARTER","CONDITION_DATERANGETYPE_NEXTQUARTER","FIXED.QUARTER",function(){return d.getDateRange(1,"QUARTER",true,true,true);}),YEARTODATE:d.getFixedRangeOperation("YEARTODATE","CONDITION_DATERANGETYPE_YEARTODATE","FIXED.YEAR",function(){return[d.getYearStartDate(new U()),d.setEndTime()];}),THISYEAR:d.getFixedRangeOperation("THISYEAR","CONDITION_DATERANGETYPE_THISYEAR","FIXED.YEAR",function(){return d.getDateRange(1,"YEAR",true);}),LASTYEAR:d.getFixedRangeOperation("LASTYEAR","CONDITION_DATERANGETYPE_LASTYEAR","FIXED.YEAR",function(){return d.getDateRange(-1,"YEAR",true);}),NEXTYEAR:d.getFixedRangeOperation("NEXTYEAR","CONDITION_DATERANGETYPE_NEXTYEAR","FIXED.YEAR",function(){return d.getDateRange(1,"YEAR",true,true,true);}),QUARTER1:d.getFixedRangeOperation("QUARTER1","CONDITION_DATERANGETYPE_QUARTER1","FIXED.QUARTER",function(){var s=d.getYearStartDate();return d.getDateRange(1,"QUARTER",s);}),QUARTER2:d.getFixedRangeOperation("QUARTER2","CONDITION_DATERANGETYPE_QUARTER2","FIXED.QUARTER",function(){var s=d.getDateRange(1,"QUARTER",d.getYearStartDate())[1];s.setMilliseconds(1000);return d.getDateRange(1,"QUARTER",s);}),QUARTER3:d.getFixedRangeOperation("QUARTER3","CONDITION_DATERANGETYPE_QUARTER3","FIXED.QUARTER",function(){var s=d.getDateRange(2,"QUARTER",d.getYearStartDate())[1];s.setMilliseconds(1000);return d.getDateRange(1,"QUARTER",s);}),QUARTER4:d.getFixedRangeOperation("QUARTER4","CONDITION_DATERANGETYPE_QUARTER4","FIXED.QUARTER",function(){var s=d.getDateRange(3,"QUARTER",d.getYearStartDate())[1];s.setMilliseconds(1000);return d.getDateRange(1,"QUARTER",s);})};d.prototype.getControls=function(o){var C=[];if(!o){return;}o.getControls(this,C,o);return C;};d.prototype.setIgnoreTime=function(i){this._bIgnoreTime=i;};T.prototype.getIgnoreTime=function(i){return this._bIgnoreTime;};d.prototype.getDefaultValues=function(o){if(!o){return[];}var e=o.defaultValues||[];if(typeof e==="function"){e=o.defaultValues();}var C=this.getCondition(),v=e[0]||null,V=e[1]||null;if(o.key==="DATERANGE"&&C&&C.value1&&C.value2){v=C.value1.oDate||C.value1;V=C.value2.oDate||C.value2;}else{if(v instanceof Date){v=new U(v);}if(V instanceof Date){V=new U(V);}}return[v,V];};d.prototype.getOperations=function(){var o=[];for(var n in d.Operations){var O=d.Operations[n];if(this._filterOperation(O)){o.push(O);}}return o;};d.prototype._updateOperation=function(o){T.prototype._updateOperation.apply(this,[o]);if(o.display){var e=this.getDefaultValues(o),f={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern};if(o.display==="start"){o.textValue=sap.ui.core.format.DateFormat.getInstance(f).format(e[0].oDate);}else if(o.display==="range"){o.textValue=sap.ui.core.format.DateFormat.getInstance(f).format(e[0].oDate)+" - "+sap.ui.core.format.DateFormat.getInstance(f).format(e[1].oDate);}}};d.prototype.updateOperations=function(){var o=this.getOperations();for(var i=0;i<o.length;i++){this._updateOperation(o[i]);}return this.oModel.setProperty("operations",o,this.getContext(),true);};d.prototype.isValidCondition=function(){var C=this.getCondition(),o=this.getOperation(C.operation);if(o&&C&&C.key&&C.operation){if("value1"in o&&"value2"in o){return"value1"in C&&C.value1!==null&&"value2"in C&&C.value2!==null;}else if("value1"in o){return"value1"in C&&C.value1!==null;}else if("value2"in o){return"value2"in C&&C.value2!==null;}else if(!("value1"in o)&&!("value2"in o)){return true;}}return false;};d.prototype.providerDataUpdated=function(u,o){};d.prototype.initialize=function(j){T.prototype.initialize.apply(this,[j]);this.oModel.suspend();var o=q.extend({},j,true);var C=(new U()).getCalendarType();if(!j.conditionTypeInfo){if(j.ranges&&j.ranges.length==1){j.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:"DATERANGE",value1:j.ranges[0].value1,value2:j.ranges[0].value2,calendarType:C}};}else{var e=this.getDefaultOperation(),k=e?e.key:"";j.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:k,calendarType:C}};}}if(j.conditionTypeInfo){j=j.conditionTypeInfo;}if(j.name&&j.data){if(j.name!==this.getName()){q.sap.log.debug("ConditionType "+this.getName()+" tries to deserialize data from "+j.name);}j=j.data;}if(!j.operation){return;}var O=this.getOperation(j.operation);if(!O){if(this.getAsync()){this.setPending(true);var t=this,h=function(E){if(E.getParameter("pending")===false){t.oFilterProvider.detachPendingChange(h);t.initialize(o);}};this.oFilterProvider.attachPendingChange(h);this.oModel.resume();return;}}if(C!==j.calendarType&&(j.calendarType==="Islamic"||C==="Islamic")&&j.operation==="SPECIFICMONTH"){j.operation="DATERANGE";var v=parseInt(j.value1,10),f=U.getInstance(new Date(),j.calendarType);f.setMonth(v);f=d.getMonthStartDate(f);V=d.getDateRange(1,"MONTH",f,true);j.value1=V[0].oDate.toISOString();j.value2=V[1].oDate.toISOString();}var p=this.getConditionContext().getObject();p.operation=j.operation;p.key=j.key;p.value1=null;p.value2=null;if(j.operation==="DATERANGE"){if(typeof j.value1==="string"){j.value1=j.value1===""?null:(new U(j.value1)).oDate;}if(typeof j.value2==="string"){j.value2=j.value2===""?null:(new U(j.value2)).oDate;}p.value1=j.value1;p.value2=j.value2;}else if(j.operation==="FROM"){if(typeof j.value1==="string"){j.value1=j.value1===""?null:(new U(j.value1)).oDate;p.value1=j.value1;}}else if(j.operation==="TO"){if(typeof j.value1==="string"){j.value1=j.value1===""?null:(new U(j.value1)).oDate;p.value1=j.value1;}}else if(["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS"].indexOf(j.operation)>-1){p.value1=j.value1;}else if(j.operation==="SPECIFICMONTH"){p.value1=j.value1+"";}else{var V=this.getDefaultValues(this.getOperation(j.operation));p.value1=V[0];p.value2=V[1];}this.serialize(true);this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;};d.prototype.serialize=function(u){var j={},C=this.getCondition();if(!C.operation){return;}var o=this.getOperation(C.operation);if(!o||!("value1"in o)){C.value1=null;}if(!o||!("value2"in o)){C.value2=null;}C.calendarType=(new U()).getCalendarType();j.conditionTypeInfo={name:this.getName(),data:C};if(this.iChangeTimer){q.sap.clearDelayedCall(this.iChangeTimer);delete this.iChangeTimer;}if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange();}if(u){this._updateProvider(j,true);}else{this.iChangeTimer=q.sap.delayedCall(1,this,this._updateProvider,[j,false]);}return j;};d.prototype._updateProvider=function(j,s){this.validate(false);j.ranges=this.getFilterRanges();j.items=[];if(this.oFilterProvider){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,j);this.oFilterProvider.setFilterData({},false,this.sFieldName);if(!s&&this.oFilterProvider._oSmartFilter&&this.oFilterProvider._oSmartFilter.getLiveMode()){this.oFilterProvider._oSmartFilter.triggerSearch(sap.ui.comp.smartfilterbar.SmartFilterBar.LIVE_MODE_INTERVAL);}}};d.prototype.getFilterRanges=function(){var C=this.getCondition(),v=[];if(C.operation==="LASTDAYS"){v=d.getDateRange(-C.value1,"DAY",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTWEEKS"){v=d.getDateRange(-C.value1,"WEEK",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTMONTHS"){v=d.getDateRange(-C.value1,"MONTH",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTQUARTERS"){v=d.getDateRange(-C.value1,"QUARTER",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="LASTYEARS"){v=d.getDateRange(-C.value1,"YEAR",true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTDAYS"){v=d.getDateRange(C.value1,"DAY",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTWEEKS"){v=d.getDateRange(C.value1,"WEEK",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTMONTHS"){v=d.getDateRange(C.value1,"MONTH",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTQUARTERS"){v=d.getDateRange(C.value1,"QUARTER",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="NEXTYEARS"){v=d.getDateRange(C.value1,"YEAR",true,true,true);C.value1=v[0];C.value2=v[1];}else if(C.operation==="SPECIFICMONTH"){var V=parseInt(C.value1,10),o=new U();o.setMonth(V);o=d.getMonthStartDate(o);v=d.getDateRange(1,"MONTH",o,true);C.value1=v[0];C.value2=v[1];}if(C.value1 instanceof U){C.value1=C.value1.oDate;}if(C.value2 instanceof U){C.value2=C.value2.oDate;}if(C.operation==="FROM"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="GE";delete C.value2;}else if(C.operation==="TO"){if(!(this.isValidCondition()&&C.value1)){return[];}C.operation="LE";delete C.value2;if(this._bIgnoreTime){C.value1=d.setStartTime(C.value1).oDate;}else{C.value1=d.setEndTime(C.value1).oDate;}}else{if(!(this.isValidCondition()&&C.value1&&C.value2)){return[];}C.operation="BT";if(this._bIgnoreTime){C.value2=d.setStartTime(C.value2).oDate;}else{C.value2=d.setEndTime(C.value2).oDate;}}C.exclude=false;C.keyField=C.key;delete C.key;return[C];};d.prototype.getTokenText=function(){return"";};d.prototype.getName=function(){return this.getMetadata().getName();};d.prototype.getType=function(){return"Edm.Date";};return d;},true);
