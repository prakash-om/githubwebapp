/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(function(){"use strict";var M=function(){this.reset();};M.prototype.reset=function(o){this._oVIZCrosstab=null;this._aCrossContextLookup=null;};M.prototype.getVizDataset=function(b,d,m,a,i){if(!this._oVIZCrosstab&&sap.viz.__svg_support){this._createVIZCrosstab(b,d,m,a,i);}return this._oVIZCrosstab||null;};M.prototype.findContext=function(c){if(this._aCrossContextLookup&&typeof c==='object'){return this._aCrossContextLookup[c.dii_a2]&&this._aCrossContextLookup[c.dii_a2][c.dii_a1];}};M.prototype._createVIZCrosstab=function(b,a,m,c,e){var C=b&&b.getContexts(0,b.getLength());if(!C||C.length===0){this.reset();return;}var A=[],f=[],g=[],h=[],k=[];jQuery.each(a,function(i,l){if(l.getAxis()===1){A.push({def:l,adapter:l._getAdapter()});}else if(l.getAxis()===2){f.push({def:l,adapter:l._getAdapter()});}else{throw new Error("currently, only axis 1 and 2 are supported");}});jQuery.each(m,function(i,l){g.push({def:l,adapter:l._getAdapter()});h.push([]);});function n(u,w,x){var l=u.length,V,i;if(l===0){return 0;}V=[];for(i=0;i<l;i++){V.push(u[i].adapter(x));}for(i=0,l=w.length;i<l;i++){if(jQuery.sap.equal(w[i],V)){return i;}}w.push(V);return w.length-1;}var o=[];var p=[];jQuery.each(C,function(I,l){var u=n(A,o,l);var w=n(f,p,l);for(var i=0;i<g.length;i++){var x=g[i].adapter(l);if(A.length===0&&f.length===0){if(h[i][0]===undefined){h[i][0]=[];}h[i][0].push(x);}else{(h[i][w]=(h[i][w]||[]))[u]=x;}}if(A.length===0&&f.length===0){u=I;}(k[w]||(k[w]=[]))[u]=l;});var L=o.length;var q=Math.max(p.length,1);for(var j=0;j<q;j++){for(var i=0;i<g.length;i++){var d=h[i][j];if(!d){d=h[i][j]=[];}if(d.length<L){d[L-1]=undefined;}}if(!k[j]){k[j]=[];}if(!k[j].length<L){k[j][L]=undefined;}}var r={};if(A.length>0){if(r.analysisAxis===undefined){r.analysisAxis=[];}var s={index:1,data:[]};for(var i=0;i<A.length;i++){var v=[];for(var j=0;j<o.length;j++){v[j]=o[j][i];}s.data.push({name:A[i].def.getName(),values:v});}r.analysisAxis.push(s);}if(f.length>0){if(r.analysisAxis===undefined){r.analysisAxis=[];}var s={index:2,data:[]};for(var i=0;i<f.length;i++){var v=[];for(var j=0;j<p.length;j++){v[j]=p[j][i];}s.data.push({name:f[i].def.getName(),values:v});}r.analysisAxis.push(s);}if(g.length>0){r.measureValuesGroup=[];for(var i=0;i<g.length;i++){if(!r.measureValuesGroup[g[i].def.getGroup()-1]){r.measureValuesGroup[g[i].def.getGroup()-1]={index:g[i].def.getGroup(),data:[]};}r.measureValuesGroup[g[i].def.getGroup()-1].data.push({name:g[i].def.getName(),values:h[i]});}for(var i=0,t=r.measureValuesGroup.length;i<t;i++){if(r.measureValuesGroup[i]===undefined){throw new Error("Measure Group "+(i+1)+" is missing.");break;}}}this._oVIZCrosstab=new sap.viz.data.CrosstableDataset();this._oVIZCrosstab.setData(r);if(c){this._oVIZCrosstab.info(c);}if(e){this._oVIZCrosstab.info(e);}this._aCrossContextLookup=k;};return M;},true);
