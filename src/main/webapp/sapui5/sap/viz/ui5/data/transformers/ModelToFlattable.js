/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(function(){"use strict";var M=function(){this.reset();};M.prototype.reset=function(O){this._oVIZFlatTable=null;this._aFlatContextLookup=null;};var o=Object.prototype.toString;function a(i){return o.call(i)==='[object Array]';}M.prototype.getVizDataset=function(b,d,m,c,i,e,p,f){if(!this._oVIZFlatTable&&sap.viz.__svg_support){this._createVIZFlatTable(b,d,m,e,p,f);}return this._oVIZFlatTable||null;};M.prototype.findContext=function(c){if(this._aFlatContextLookup&&typeof c==='object'&&c._context_row_number!==undefined){return this._aFlatContextLookup[c._context_row_number];}};M.prototype._createVIZFlatTable=function(b,d,m,c,p,e){var f=(!c||c.startIndex===undefined)?0:c.startIndex;var l;if(!c||c.length===undefined){if(b){l=b.getLength();}}else{l=c.length;}var g=['_context_row_number'];if(e){if(!a(e)){e=[e];}for(var i=0;i<e.length;++i){var n=e[i];var s=!(n.showInTooltip===false);if(n.id){n=n.id;}g.push({id:n,showInTooltip:s});}}var A=[],h=[],k={'metadata':{'fields':[]},'context':g,'data':[]},C=[];jQuery.each(d,function(i,j){A.push({def:j,vAdapter:j._getAdapter(),dAdapter:j._getDisplayValueAdapter()});var v=j.getDataType();k.metadata.fields.push({'id':j.getIdentity()||j.getName(),'name':j.getName()||j.getIdentity(),'semanticType':'Dimension','dataType':v,'inResult':j.getInResult()});});jQuery.each(m,function(i,j){h.push({def:j,adapter:j._getAdapter()});var v={'id':j.getIdentity()||j.getName(),'name':j.getName()||j.getIdentity(),'semanticType':'Measure'};if(j.getFormat()){v.formatString=j.getFormat();}if(j.getUnit()){v.unit=j.getUnit();}var R=j.getRange();if(R&&R.length){v.min=R[0];v.max=R[1];}k.metadata.fields.push(v);});var q,r,t,u=sap.ui.require("sap/ui/model/analytics/AnalyticalBinding"),O=sap.ui.require("sap/ui/model/odata/ODataListBinding");if(b){if((u&&b instanceof u)||(O&&b instanceof O)){if(p){q=p.iStartIndex;r=p.iLength;if(p.bEnabled){k.metadata.options={pagination:{mode:p.sMode,ratio:p.thumbRatio}};}this._iRenderedPageNo=p.iPageNo;}else{q=0;if(u&&b instanceof u){r=+b.getTotalSize();}else{r=+b.getLength();}r=Math.max(r,0);}t=b.getContexts(q,r);}else{t=b&&b.getContexts(f,l);}}if(!t||t.length===0){this.reset();this._oVIZFlatTable=new sap.viz.api.data.FlatTableDataset(k);return;}jQuery.each(t,function(I,v){if(!k.data[I]){k.data[I]=[];}for(var i=0;i<A.length;i++){var w=A[i].vAdapter(v);if(w instanceof Date){w=w.getTime();}var V=A[i].dAdapter(v);k.data[I].push(V.enableDisplayValue?{v:w,d:V.value}:w);}for(var j=0;j<h.length;j++){var w=h[j].adapter(v);k.data[I].push(w);}C[I]=v;});this._aFlatContextLookup=C;this._oVIZFlatTable=new sap.viz.api.data.FlatTableDataset(k);};M.prototype.getRenderedPageNo=function(){return this._iRenderedPageNo;};return M;},true);
